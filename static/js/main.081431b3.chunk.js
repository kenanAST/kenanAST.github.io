(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{124:function(e,t){e.exports={image:["image/*"],document:[".pdf",".vcf","application/pdf"],video:[".mp4",".avi",".webm",".gif",".wmv",".mpg",".mpeg",".m2v",".flv",".ogg"],audio:[".mp3",".ogg",".mpeg",".3gp",".wav",".webm",".m4p",".amr"]}},438:function(e,t,a){const n=a(19),s={fileToDataUrl:e=>new Promise((t,a)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=(()=>t(n.result)),n.onerror=(e=>a(e))}),dataUrlToBlob:e=>{var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var a=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return new Blob([n],{type:a})},getExtension:function(e){if(!e||!n.isString(e))return"";const t=e.split(".");return 1===t.length?"":t[t.length-1]}};e.exports=s},600:function(e,t){e.exports={cas_user_types:["staff","undergrad","postgrad","department","emeritus","nansha-staff","project","affiliate","family-google"],admin_roles:["super_user","system_admin","facility_admin"],user_roles:["priority_booker_all_department","priority_booker_department","department","individual"],group_types:["department","staff_group","student_group"],booking_types:["general","event","blackout","music_performance"],booking_form_types:["general","event","blackout","music_performance"],day_of_week:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],room_review_types:["recommendation","defect_report"],quota_schemes:["university","department"],submission_types:["music_performance_audition"],status:["active","inactive"]}},618:function(e,t,a){e.exports=a(987)},628:function(e,t,a){e.exports=a.p+"static/media/index.9b5a0eca.less"},691:function(e,t,a){},821:function(e,t,a){},905:function(e,t){},908:function(e,t,a){},987:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(58),i=a.n(o),l=a(38),r=a(106),c=a(29),d=a(575),m=a(601),p=a(8),u=a(576),g=a.n(u);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(627),a(628),a(629);var h=a(20),E=a(454),f=a(577),y=a(117),b=a(1021);const _="RESET_LOGIN_PAGE",k="RESET_LOGIN_PAGE_META",S="LOGIN_REQUEST",w="LOGIN_SUCCESS",T="LOGIN_ERROR",C="UPDATE_ACCOUNT_STATUS_REQUEST",v="UPDATE_ACCOUNT_STATUS_ERROR",I="UPDATE_ACCOUNT_STATUS_SUCCESS",x="GET_TICKETS_REQUEST",A="GET_TICKETS_ERROR",P="GET_TICKETS_SUCCESS",O="UPDATE_TICKET_ASIGNEE_REQUEST",R="UPDATE_TICKET_ASIGNEE_ERROR",F="UPDATE_TICKET_ASIGNEE_SUCCESS",M="UPDATE_TICKET_STATUS_REQUEST",D="UPDATE_TICKET_STATUS_ERROR",N="UPDATE_TICKET_STATUS_SUCCESS",j="RESET_TICKETS_PAGE_META",U="RESET_TICKETS_PAGE",B="RESET_MESSAGES",L="GET_TICKET_BY_ID_REQUEST",G="GET_TICKET_BY_ID_ERROR",H="GET_TICKET_BY_ID_SUCCESS",W="SEND_MESSAGE_REQUEST",z="SEND_MESSAGE_SUCCESS",$="SEND_MESSAGE_ERROR",q="GET_MESSAGES_REQUEST",V="GET_MESSAGES_SUCCESS",K="GET_MESSAGES_ERROR",Y="SEND_ATTACHMENT_REQUEST",Q="SEND_ATTACHMENT_SUCCESS",J="SEND_ATTACHMENT_ERROR",Z="GET_TICKET_STAFFS_ERROR",X="GET_TICKET_STAFFS_REQUEST",ee="GET_TICKET_STAFFS_SUCCESS",te="GET_TWILIO_MESSAGE_BY_ID_REQUEST",ae="GET_TWILIO_MESSAGE_BY_ID_ERROR",ne="GET_TWILIO_MESSAGE_BY_ID_SUCCESS",se="NEW_TICKET_REQUEST",oe="NEW_TICKET_ERROR",ie="NEW_TICKET_SUCCESS",le="ADD_TICKET_NOTE_ERROR",re="ADD_TICKET_NOTE_SUCCESS",ce="ADD_TICKET_NOTE_REQUEST",de="UPDATE_CUSTOMER_REQUEST",me="UPDATE_CUSTOMER_ERROR",pe="UPDATE_CUSTOMER_SUCCESS",ue="GET_REGISTER_PAGE_REQUEST",ge="GET_REGISTER_PAGE_ERROR",he="GET_REGISTER_PAGE_SUCCESS",Ee="RESET_REGISTER_PAGE_META",fe="RESET_REGISTER_PAGE",ye="SUBMIT_REGISTER_PAGE_ERROR",be="SUBMIT_REGISTER_PAGE_REQUEST",_e="SUBMIT_REGISTER_PAGE_SUCCESS",ke="GET_FORGOT_PASSWORD_PAGE_REQUEST",Se="GET_FORGOT_PASSWORD_PAGE_ERROR",we="GET_FORGOT_PASSWORD_PAGE_SUCCESS",Te="RESET_FORGOT_PASSWORD_PAGE_META",Ce="RESET_FORGOT_PASSWORD_PAGE",ve="UPDATE_SETTINGS_ACCOUNT_REQUEST",Ie="UPDATE_SETTINGS_ACCOUNT_ERROR",xe="UPDATE_SETTINGS_ACCOUNT_SUCCESS",Ae="GET_SETTINGS_ACCOUNT_REQUEST",Pe="GET_SETTINGS_ACCOUNT_ERROR",Oe="GET_SETTINGS_ACCOUNT_SUCCESS",Re="RESET_ACCOUNT_PAGE",Fe="RESET_ACCOUNT_PAGE_META",Me="GET_CONNECTIONS_REQUEST",De="GET_CONNECTIONS_ERROR",Ne="GET_CONNECTIONS_SUCCESS",je="GET_PAGES_REQUEST",Ue="GET_PAGES_ERROR",Be="GET_PAGES_SUCCESS",Le="RESET_MESSENGER_INTEGRATION_PAGE",Ge="RESET_MESSENGER_INTEGRATION_PAGE_META",He="GET_REPORTS_REQUEST",We="GET_REPORTS_ERROR",ze="GET_REPORTS_SUCCESS",$e="RESET_REPORTS_PAGE",qe="RESET_REPORTS_PAGE_META",Ve="GET_STAFFS_REQUEST",Ke="GET_STAFFS_ERROR",Ye="GET_STAFFS_SUCCESS",Qe="GET_STAFF_BY_ID_REQUEST",Je="GET_STAFF_BY_ID_ERROR",Ze="GET_STAFF_BY_ID_SUCCESS",Xe="DELETE_STAFF_BY_ID_REQUEST",et="DELETE_STAFF_BY_ID_ERROR",tt="DELETE_STAFF_BY_ID_SUCCESS",at="UPDATE_STAFF_REQUEST",nt="UPDATE_STAFF_ERROR",st="UPDATE_STAFF_SUCCESS",ot="SUBMIT_STAFF_REQUEST",it="SUBMIT_STAFF_SUCCESS",lt="SUBMIT_STAFF_ERROR",rt="RESET_SELECTED_STAFF",ct="RESET_STAFF_DETAILS_PAGE",dt="RESET_STAFF_DETAILS_PAGE_META",mt="ADD_FACEBOOK_CONNECTION_REQUEST",pt="ADD_FACEBOOK_CONNECTION_SUCCESS",ut="ADD_FACEBOOK_CONNECTION_ERROR",gt="GET_FACEBOK_CONNECTIONS_ERROR",ht="GET_FACEBOK_CONNECTIONS_REQUEST",Et="GET_FACEBOK_CONNECTIONS_SUCCESS",ft="UPDATE_PAGE_SUBCRIBED_FIELD_REQUEST",yt="UPDATE_PAGE_SUBCRIBED_FIELD_ERROR",bt="UPDATE_PAGE_SUBCRIBED_FIELD_SUCCESS",_t="SEND_MESSAGE_REQUEST",kt="SEND_MESSAGE_SUCCESS",St="SEND_MESSAGE_ERROR",wt="GET_FACEBOOK_MESSAGES_REQUEST",Tt="GET_FACEBOOK_MESSAGES_SUCCESS",Ct="GET_FACEBOOK_MESSAGES_ERROR",vt="GET_FACEBOOK_MESSAGE_BY_ID_REQUEST",It="GET_FACEBOOK_MESSAGE_BY_ID_ERROR",xt="GET_FACEBOOK_MESSAGE_BY_ID_SUCCESS",At="ADD_TWILIO_CONNECTION_REQUEST",Pt="ADD_TWILIO_CONNECTION_SUCCESS",Ot="ADD_TWILIO_CONNECTION_ERROR",Rt="GET_TWILIO_CONNECTIONS_REQUEST",Ft="GET_TWILIO_CONNECTIONS_ERROR",Mt="GET_TWILIO_CONNECTIONS_SUCCESS",Dt="GET_TWILIO_CONNECTION_BY_ID_ERROR",Nt="GET_TWILIO_CONNECTION_BY_ID_REQUEST",jt="GET_TWILIO_CONNECTION_BY_ID_SUCCESS",Ut="UPDATE_TWILIO_CONNECTION_REQUEST",Bt="UPDATE_TWILIO_CONNECTION_SUCCESS",Lt="UPDATE_TWILIO_CONNECTION_ERROR",Gt={loading:!1,email:"",password:"",error:""};function Ht(e=Gt,t){switch(t.type){case S:return{...e,...t.payload,loading:!0,error:""};case w:return{...e,...t.payload,password:"",error:""};case T:return{...e,error:t.payload.error,...t.payload,password:"",loading:!1};case _:return{...Gt};case k:return{...e,meta:null};default:return e}}const Wt={loading:!1,register:null};function zt(e=Wt,t){switch(t.type){case ue:case he:case ge:case _e:case be:case ye:return{...e,...t.payload};case Ee:return{...e,meta:null};case fe:return{...Wt};default:return e}}const $t={loading:!1,forgot_password:null};function qt(e=$t,t){switch(t.type){case ke:case we:case Se:return{...e,...t.payload};case Te:return{...e,meta:null};case Ce:return{...$t};default:return e}}const Vt={loading:!1,tickets:[],twilio_messages:[],users:[],loadingUsers:!1,loadingMessage:!1,loadingTickets:!1,loadingSelectedTicket:!1,loadingSendMessage:!1,loadingNewTicket:!1,showNewTicketAssignedModal:!1,fb_messages:[]};function Kt(e=Vt,t){switch(t.type){case x:case P:case A:case M:case D:case N:case O:case R:case F:case $:case W:case z:case K:case q:case V:case Q:case J:case Y:case H:case L:case G:case ee:case X:case Z:case ne:case te:case ae:case se:case oe:case ie:case pe:case de:case me:case ce:case re:case le:case wt:case Tt:case Ct:case vt:case It:case xt:return{...e,...t.payload};case j:return{...e,meta:null};case B:return{...e,twilio_messages:[],fb_messages:[],staffs:[],ticket:[]};case U:return{...Vt};default:return e}}const Yt={loading:!1,account:null,staffs:[],loadingAccount:!1,loadingStaffs:!1,loadingStaffModal:!1};function Qt(e=Yt,t){switch(t.type){case Ve:case Ke:case Ye:return{...e,...t.payload};case Fe:return{...e,meta:null};case Re:return{...Yt};case rt:return{...e,selectedStaff:null};default:return e}}const Jt={loading:!1,account:null,loadingSubmit:!1,staffs:[],connections:[],facebook_connections:[],selectedStaff:null,twilio_connections:[],selectedTwilio_connection:null,loadingTwilioForm:!1,loadingTwilioData:!1,loadingAccount:!1,loadingStaffs:!1,loadingStaffModal:!1,loadingDeleteStaff:!1,loadingConnections:!1,loadingFacebookConnections:!1,loadingTwilioConnections:!1};function Zt(e=Jt,t){switch(t.type){case Ae:case Oe:case Pe:case ve:case xe:case Ie:case st:case at:case nt:case Ve:case Ke:case Ye:case Qe:case Je:case Ze:case tt:case Xe:case et:case v:case C:case I:case Me:case De:case Ne:case ut:case mt:case pt:case ht:case gt:case Et:case ft:case bt:case yt:case At:case Ot:case Pt:case Rt:case Ft:case Mt:case Ut:case Lt:case Bt:case Nt:case Dt:case jt:return{...e,...t.payload};case Fe:return{...e,meta:null};case Re:return{...Jt};case rt:return{...e,selectedStaff:null};default:return e}}const Xt={loading:!1,staff:{}};function ea(e=Xt,t){switch(t.type){case Qe:case Ze:case Je:case ot:case it:case lt:return{...e,...t.payload};case dt:return{...e,meta:null};case ct:return Xt;default:return e}}const ta={loading:!1,pages:[]};function aa(e=ta,t){switch(t.type){case je:case Ue:case Be:return{...e,...t.payload};case Fe:return{...e,meta:null};case Re:return{...ta};default:return e}}const na={loading:!1,reports:[]};function sa(e=na,t){switch(t.type){case He:case We:case ze:return{...e,...t.payload};case qe:return{...e,meta:null};case Re:return{...na};default:return e}}const oa=Object(y.a)({basename:"/"});let ia;var la=a(132),ra=a(55),ca=a.n(ra);const da={development:{api:"http://localhost:3000",loginTimeout:86400,socket:{host:"http://localhost:3000",path:"/socket.io"},facebook:{app_id:"2571818449753064"}},testing:{api:"https://anndesk.com/api",loginTimeout:86400,socket:{host:"https://anndesk.com/api",path:"/socket.io"},facebook:{app_id:"2850616228310859"}},production:{api:"https://api.anndesk.com",loginTimeout:86400,socket:{host:"https://api.anndesk.com",path:"/socket.io"},facebook:{app_id:"511084842884328"}}};var ma=da.development||da.development;var pa={isAuthenticated(){const e=JSON.parse(localStorage.getItem("app"));if(!e)return!1;const{token:t,last_login:a}=e,n=ca()();if(t&&a){return n.diff(ca()(new Date(a)).toISOString(),"seconds")<ma.loginTimeout}return!1}};a(691);const ua={primary:"#006FBB"};var ga=class extends n.Component{render(){return s.a.createElement(p.a,{features:{newDesignLanguage:!0},theme:{colors:ua}},s.a.createElement("div",{style:{paddingLeft:20,paddingRight:20,paddingTop:40}},this.props.children))}},ha=a(996),Ea=a(1013),fa=a(1020),ya=a(232),ba=a(75),_a=a(56),ka=a.n(_a),Sa=a(203),wa=a(205);const{SubMenu:Ta}=ya.a,{Sider:Ca}=ha.a,va=["sub-bookings","sub-projects","sub-job-orders","sub-users","sub-serv-groups-and-equipment","sub-advanced","sub-consums-assories","sub-consum-orders","sub-billings"];var Ia=class extends n.Component{constructor(...e){super(...e),this.state={openKeys:[]},this.onOpenChange=(e=>{const t=e.find(e=>-1===this.state.openKeys.indexOf(e));-1===va.indexOf(t)?this.setState({openKeys:e}):this.setState({openKeys:t?[t]:[]})})}componentDidMount(){this.getActiveSubmenu()}getActiveItem({pathname:e,search:t}){const{query:a}=ka()(t,!0);switch(!0){case/\/dashboard/.test(e):return["dashboard"];case/\/staffs/.test(e):return["staffs"];case/\/tickets/.test(e):return["tickets"];case/\/settings/.test(e):return["settings"];case/\/reports/.test(e):return["reports"];case/\/subscription/.test(e):return["subscription"];case/\/messenger-integration/.test(e):return["messenger-integration"];case/\/messenger-settings/.test(e):return["messenger-settings"];case/\/jo-sams/.test(e):return["jo-sams"];case/\/jo-workflows/.test(e):return["jo-workflows"];case/\/users/.test(e):return["users"];case/\/pis/.test(e):return["pis"];case/\/user-application-settings/.test(e):return["user-application-settings"];case/\/user-application/.test(e):return["user-application"];case/\/external-user-application-settings/.test(e):return["external-user-application-settings"];case/\/external-user-application/.test(e):return["external-user-application"];case/\/servgp/.test(e):return["servgp"];case/\/equips/.test(e):case/\/equip-workflows/.test(e):case/\/equip-penalties/.test(e):case/\/equip-bks/.test(e):case/\/equip-charging-schemes/.test(e):return["equips"];case/\/assories/.test(e):return["assories"];case/\/consums/.test(e):return["consums"];case/\/admins/.test(e):return["admins"];case/\/charge-types/.test(e):return["charge-types"];case/\/user-types/.test(e):return["user-types"];case/\/locations/.test(e):return["locations"];case/\/assorycats/.test(e):return["assorycats"];case/\/consumcats/.test(e):return["consumcats"];case/\/consum-inventory/.test(e):return["consum-inventory"];case/\/consum-batch-maintain/.test(e):return["consum-batch-maintain"];case/\/skills/.test(e):return["skills"];case/\/trainings/.test(e):return["trainings"];case/\/users/.test(e):return["users"];default:return}}getActiveSubmenu(){const e=this.props.location.pathname;switch(!0){case/\/subscriptions/.test(e):this.setState({openKeys:["subscriptions"]});break;case/\/settings/.test(e):this.setState({openKeys:["settings"]});break;case/\/subscription/.test(e)||/\/project-types/.test(e):this.setState({openKeys:["subscription"]});break;case/\/jo-forms/.test(e)||/\/jo-types/.test(e)||/\/jo-sams/.test(e)||/\/jo-workflows/.test(e):this.setState({openKeys:["sub-job-orders"]});break;case/\/admins/.test(e)||/\/charge-types/.test(e)||/\/user-types/.test(e)||/\/locations/.test(e):this.setState({openKeys:["sub-advanced"]});break;case/\/users/.test(e)||/\/pis/.test(e)||/\/user-application/.test(e)||/\/user-application-settings/.test(e)||/\/external-user-application/.test(e)||/\/external-user-application-settings/.test(e):this.setState({openKeys:["sub-users"]});break;case/\/equips/.test(e)||/\/servgp/.test(e):this.setState({openKeys:["sub-serv-groups-and-equipment"]});break;case/\/assories/.test(e)||/\/consums/.test(e)||/\/consumcats/.test(e)||/\/assorycats/.test(e)||/\/consum-inventory/.test(e)||/\/consum-batch-maintain/.test(e):this.setState({openKeys:["sub-consums-assories"]});break;case/\/skills/.test(e)||/\/trainings/.test(e):this.setState({openKeys:["sub-skills-and-trainings"]})}}render(){const e=this.getActiveItem({pathname:this.props.location.pathname,search:this.props.location.search});return s.a.createElement(Ca,{trigger:null,breakpoint:"lg",collapsedWidth:"0",onCollapse:this.props.handleOnCollapse,collapsed:this.props.collapsed,width:"256",style:{zIndex:30}},s.a.createElement("div",{className:"menu-logo"}),s.a.createElement(ya.a,{theme:"dark",mode:"inline",openKeys:this.state.openKeys,onOpenChange:this.onOpenChange,selectedKeys:e},s.a.createElement("div",{style:{textAlign:"center",margin:"1em",padding:"1em"}},s.a.createElement("span",{style:{fontSize:"20px"}},s.a.createElement(ba.a,{to:"/dashboard",style:{color:"white"}},"Anndesk"))),s.a.createElement(ya.a.Item,{key:"dashboard"},s.a.createElement(Sa.a,{icon:wa.e,fixedWidth:!0}),s.a.createElement("span",{style:{marginLeft:10}},"Dashboard"),s.a.createElement(ba.a,{to:"/dashboard"})),s.a.createElement(ya.a.Item,{key:"tickets"},s.a.createElement(Sa.a,{icon:wa.b,fixedWidth:!0}),s.a.createElement("span",{style:{marginLeft:10}},"Tickets"),s.a.createElement(ba.a,{to:"/tickets"})),s.a.createElement(ya.a.Item,{key:"staffs"},s.a.createElement(Sa.a,{icon:wa.f,fixedWidth:!0}),s.a.createElement("span",{style:{marginLeft:10}},"Staff"),s.a.createElement(ba.a,{to:"/staffs"})),s.a.createElement(Ta,{key:"sub-bookings",icon:s.a.createElement(Sa.a,{icon:wa.a,fixedWidth:!0}),title:"Channel"},s.a.createElement(ya.a.Item,{key:"messenger-integration"},s.a.createElement("span",{className:"nav-text"},"Messenger Integration"),s.a.createElement(ba.a,{to:"/messenger-integration"})),s.a.createElement(ya.a.Item,{key:"messenger-settings"},s.a.createElement("span",{className:"nav-text"},"Messenger Settings"),s.a.createElement(ba.a,{to:"/messenger-settings"}))),s.a.createElement(ya.a.Item,{key:"reports"},s.a.createElement(Sa.a,{icon:wa.d,fixedWidth:!0}),s.a.createElement("span",{style:{marginLeft:10}},"Reports"),s.a.createElement(ba.a,{to:"/reports"})),s.a.createElement(Ta,{key:"settings",icon:s.a.createElement(Sa.a,{icon:wa.c,fixedWidth:!0}),title:"Settings"},s.a.createElement(ya.a.Item,{key:"settings"},s.a.createElement("span",{className:"nav-text"},"My Account"),s.a.createElement(ba.a,{to:"/settings"})),s.a.createElement(ya.a.Item,{key:"subscription"},s.a.createElement("span",{className:"nav-text"},"Subscription"),s.a.createElement(ba.a,{to:"/subscription"})))))}},xa=a(1023),Aa=a(278),Pa=a(1019),Oa=a(1022),Ra=a(352),Fa=a(997),Ma=a(19),Da=a.n(Ma);var Na={getName(){try{const{admin:t,staff:a}=JSON.parse(localStorage.getItem("app"));return t&&t.name||a&&a.name}catch(e){}return""},getLoginType(){try{return JSON.parse(localStorage.getItem("app")).type}catch(e){}return""},getUserId(){try{const{admin:t,staff:a}=JSON.parse(localStorage.getItem("app"));return t&&t._id||a&&a.parent_user_id}catch(e){}return""},getLoggedIn(){try{const{admin:t,staff:a}=JSON.parse(localStorage.getItem("app"));return t&&t||a&&a}catch(e){}return""}};const{Header:ja}=ha.a,{SubMenu:Ua}=ya.a,{Option:Ba}=Aa.a,{Title:La,Link:Ga}=Ea.a;var Ha=class extends n.Component{constructor(...e){super(...e),this.handleLanguageMenuClick=(()=>{}),this.handleSettingMenuClick=(()=>{}),this.handleLogout=(()=>{this.props.history.push("/logout")}),this.getUsernameAvatar=((e,t="large")=>s.a.createElement("div",null,s.a.createElement(Pa.a,{style:{color:"#322105",backgroundColor:"#faa61a",verticalAlign:"middle"},size:t},e?e.charAt(0).toUpperCase():""),s.a.createElement("span",{style:{paddingLeft:20}},e)))}render(){const e=s.a.createElement(ya.a,null,s.a.createElement(ya.a.Item,{key:"setting:2",onClick:this.handleLogout},s.a.createElement("span",null,s.a.createElement(Oa.b,null,s.a.createElement(xa.a,null),"Logout"))));return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,s.a.createElement(ja,{trigger:null,className:"header fixed-header-action",style:{background:"#fff",width:"100%"}},s.a.createElement(Oa.b,{align:"end",style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(s.a.Fragment,null," "),s.a.createElement(Ra.a,{className:"header-user-part",overlay:e,placement:"bottomRight"},s.a.createElement(Fa.a,{justify:"space-around",style:{alignSelf:"center",display:"inline-flex",marginRight:"15px",maxWidth:"200px",border:"none",whiteSpace:"nowrap"}},this.getUsernameAvatar(Na.getName())))))))}};const Wa={queryStringToObject(e){if(!e||!Da.a.isString(e))return{};0===e.indexOf("?")&&(e=e.substring(1));try{return JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch(t){}return{}},isEmailValid:e=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),isUstEmail:e=>!(!e||!Wa.isEmailValid(e))&&(Da.a.endsWith(e,"@ust.hk")||Da.a.endsWith(e,".ust.hk")),getImageBasePath(){let e="";return e=""}};var za=Wa;const{Header:$a,Content:qa,Footer:Va}=ha.a,{Title:Ka}=Ea.a;var Ya=class extends n.Component{constructor(...e){super(...e),this.state={collapsed:!1,BreadcrumbSection:[{key:"homePage",content:"Lab Booking System",active:!0}],BreadcrumbTitle:" "},this.handleOnCollapse=(()=>{this.setState({collapsed:!this.state.collapsed})}),this.setBreadcrumbNavigationBar=(e=>{this.setState({BreadcrumbSection:e})}),this.setBreadcrumbTitle=(e=>{this.setState({BreadcrumbTitle:e})}),this.ShowNavigationBar=(()=>{var e=this.state.BreadcrumbSection,t=this.state.BreadcrumbTitle;return s.a.createElement($a,{className:"breadcrumb-header",style:{marginTop:64}},s.a.createElement(fa.a,null,e&&e.map(e=>s.a.createElement(fa.a.Item,{key:e.key},e.link?s.a.createElement("a",{href:"#",onClick:e.onClick},e.content):e.content))),s.a.createElement(Ka,{level:5,style:{paddingTop:10}},t))})}render(){const{location:e,history:t}=this.props.children.props;var a=this.setBreadcrumbNavigationBar.bind(this),n=this.setBreadcrumbTitle.bind(this);return s.a.createElement(ha.a,{style:{minHeight:"100vh"}},s.a.createElement(Ia,{location:e,history:t,collapsed:this.state.collapsed,handleOnCollapse:()=>this.handleOnCollapse()}),s.a.createElement(ha.a,null,s.a.createElement(Ha,{location:e,history:t,collapsed:this.state.collapsed,handleOnCollapse:()=>this.handleOnCollapse()}),s.a.createElement(qa,{style:{margin:"16px 16px 0"}},s.a.cloneElement(this.props.children,{setBreadcrumbNavigationBar:a,setBreadcrumbTitle:n}))))}},Qa=a(239),Ja=a(1012),Za=a(145),Xa=a(998),en=a(1017),tn=a(1014);const an=({input:e,meta:{touched:t,invalid:a,error:n},...o})=>s.a.createElement(p.x,Object.assign({},e,o,{error:t&&!Da.a.isNil(n),autoComplete:"off"})),nn=({input:e,meta:{touched:t,invalid:a,error:n},...o})=>s.a.createElement(p.i,Object.assign({},e,o,{error:t&&!Da.a.isNil(n),onChange:t=>e.onChange(t)})),sn=e=>e||"number"===typeof e?void 0:"Required",on=e=>{return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},ln=e=>on(e)?void 0:"Invalid Email";a(821);var rn=a(354);var cn=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"LoginPage"}))(class extends n.Component{componentDidUpdate(e){const{meta:t}=e.loginPageProps,{meta:a}=this.props.loginPageProps;if(a&&a!==t){const e={type:200===a.code?"success":"error",...40399===a.code&&{timeout:0}};this.props.alert.show(a.message,e),this.props.resetMeta()}}componentWillUnmount(){this.props.resetPage()}render(){const{pristine:e,submitting:t,invalid:a,loadingSubmit:n}=this.props;return s.a.createElement(Fa.a,{style:{height:"92vh"},justify:"center",align:"middle"},s.a.createElement(rn.a,{pageId:"286645431852598",language:"sv_SE",themeColor:"#000000",bottomSpacing:300,loggedInGreeting:"loggedInGreeting",loggedOutGreeting:"loggedOutGreeting",greetingDialogDisplay:"show",debugMode:!0,onMessengerShow:()=>{console.log("onMessengerShow")},onMessengerHide:()=>{console.log("onMessengerHide")},onMessengerDialogShow:()=>{console.log("onMessengerDialogShow")},onMessengerDialogHide:()=>{console.log("onMessengerDialogHide")},onMessengerMounted:()=>{console.log("onMessengerMounted")},onMessengerLoad:()=>{console.log("onMessengerLoad")}}),s.a.createElement("div",{style:{width:"40em",margin:"auto"}},s.a.createElement("br",null),s.a.createElement(p.h,null,s.a.createElement("center",{style:{float:"center",padding:"50px"}},s.a.createElement(p.k,{size:"large",element:"h2"},"Sign in to ",s.a.createElement("span",{style:{color:"#0088ff"}},"anndesk")),s.a.createElement(p.k,{size:"small"},"Enter your details below")),s.a.createElement(p.h.Section,null,s.a.createElement(p.l,{onSubmit:this.props.handleSubmit(e=>this.props.login(e))},s.a.createElement(p.m,null,s.a.createElement(en.a,{style:{width:"10px"},name:"email",label:"Email Address",component:an,validate:[ln,sn]}),s.a.createElement(en.a,{name:"password",label:"Password",type:"password",component:an,validate:[sn]}),s.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},s.a.createElement(Qa.a,{onChange:e=>e.target.checked},"Remember Me"),s.a.createElement("span",{style:{float:"right"}},s.a.createElement(ba.a,{id:"forgot-password",to:"/forgot-password"},"Forgot your Password?"))),s.a.createElement("br",null),s.a.createElement(Za.a,{type:"primary",block:!0,style:{background:"#09509d",borderColor:"#09509d"},onClick:this.props.handleSubmit(e=>this.props.login(e))},"Login")))),s.a.createElement(Xa.a,{style:{paddingLeft:25,paddingRight:25},orientation:"center"},s.a.createElement("span",{style:{color:"grey"}},"or")),s.a.createElement(p.h.Section,null,s.a.createElement(p.f,{fullWidth:!0,id:"google-button"},s.a.createElement(Oa.b,null,s.a.createElement(Ja.a,{width:20,src:`${za.getImageBasePath()}/images/google-logo.svg`,preview:!1}),s.a.createElement("div",null,"Continue with Google"))),s.a.createElement("center",{style:{margin:"2em"}},s.a.createElement(p.y,null,s.a.createElement("span",{style:{color:"#9b9ba1"}},"Don't have an account? \xa0"),s.a.createElement(ba.a,{style:{textDecoration:"none"},to:"/register"},s.a.createElement("strong",{style:{color:"#09509d"}},"Get Started"))))))))}}),dn=a(95),mn=a(277),pn=a.n(mn);const un=()=>localStorage.getItem("app")?JSON.parse(localStorage.getItem("app")).token:"",gn=e=>-1!==[4031,4032].indexOf(Da.a.get(e,"meta.code")),hn=()=>{localStorage.removeItem("app"),oa.push(`/login?path=${oa.location.pathname}${oa.location.search}${oa.location.hash}`)};var En={get:(e,t={})=>new Promise(function(a,n){pn.a.get(`${ma.api}${e}`).set("Accept","application/json").set("Content-Type","application/json").set("Authorization",`Bearer ${un()}`).query(t).end((e,t)=>{if(e)return n({error:e,result:t});gn(t.body)?hn():a(t.body)})}),post:(e,t={})=>new Promise(function(a,n){pn.a.post(`${ma.api}${e}`).set("Accept","application/json").set("Content-Type","application/json").set("Authorization",`Bearer ${un()}`).send(t).end((e,t)=>{if(e)return n({error:e,result:t});gn(t.body)?hn():a(t.body)})}),patch:(e,t={})=>(console.log("url, body"+e,t),new Promise(function(a,n){pn.a.patch(`${ma.api}${e}`).set("Accept","application/json").set("Content-Type","application/json").set("Authorization",`Bearer ${un()}`).send(t).end((e,t)=>{if(e)return n({error:e,result:t});gn(t.body)?hn():a(t.body)})})),delete:(e,t={})=>new Promise(function(a,n){pn.a.del(`${ma.api}${e}`).set("Accept","application/json").set("Content-Type","application/json").set("Authorization",`Bearer ${un()}`).query(t).end((e,t)=>{if(e)return n({error:e,result:t});gn(t.body)?hn():a(t.body)})})},fn={admin:{accounts:{getAccount:async e=>await En.get("/app/account/me",e),updateAccount:async e=>await En.patch("/app/account/me",e),updateStatus:async({status:e})=>await En.patch(`/app/account/update-status/me?status=${e}`)},twilioconnections:{twilio:{getTwilioConnections:async e=>await En.get("/admin/twilio-connections/me",e),getTwilioConnectionById:async e=>await En.get(`/admin/twilio-connections/id?id=${e}`),createTwilioConnection:async e=>await En.post("/admin/twilio-connections/me",e),updateTwilioConnectionById:async({id:e,body:t})=>await En.patch(`/admin/twilio-connections/id?id=${e}`,t)}},connections:{facebook:{getFacebookConnections:async e=>await En.get("/app/facebook-connections/me",e),createFacebookConnection:async e=>await En.post("/app/facebook-connections",e),updatePageSubcribedFieldById:async({id:e,body:t})=>await En.patch(`/app/facebook-pages/update-subscribedfield/id?id=${e}`,t)}},tickets:{getTickets:async e=>await En.get("/app/tickets",e),getTicketById:async e=>await En.get(`/app/tickets/id?id=${e}`),updateTicketAsigneeById:async({id:e,user_id:t})=>await En.patch(`/app/tickets/id/update-asignee?id=${e}&user_id=${t}`),updateTicketStatusById:async({id:e,status:t})=>await En.patch(`/app/tickets/id/update-status?id=${e}&status=${t}`),createTicketNote:async({id:e,body:t})=>await En.post(`/app/tickets/id/create-note?id=${e}`,t)},messages:{getTwilioMessages:async e=>await En.get(`/app/twilio-messages?ticket_id=${e}`),getTwilioMessageById:async e=>await En.get(`/app/twilio-messages/id?id=${e}`),createTwilioMessage:async e=>await En.post("/app/twilio-messages",e),getFbMessages:async e=>await En.get(`/app/facebook-messages?ticket_id=${e}`),getFbMessagesByID:async e=>await En.get(`/app/facebook-messages/id?id=${e}`),createFbMessage:async e=>await En.post("/app/facebook-messages",e)},users:{getUsers:async e=>await En.get("/app/users",e&&{type:e}),getStaffs:async()=>await En.get("/app/staffs"),getStaffById:async e=>await En.get(`/app/staffs/id?id=${e}`),createStaff:async e=>await En.post("/app/staffs",e),updateStaffById:async(e,t)=>await En.patch(`/app/staffs/id?id=${e}`,t),deleteStaffById:async e=>await En.delete(`/app/staffs/id?id=${e}`)},contacts:{updateTwilioContact:async({id:e,body:t})=>await En.patch(`/app/twilio-contacts/id?id=${e}`,t)}},staff:{tickets:{getTickets:async e=>await En.get("/staff/tickets",e),getTicketById:async e=>await En.get(`/staff/tickets/id?id=${e}`),updateTicketStatusById:async({id:e,status:t})=>await En.patch(`/staff/tickets/id/update-status?id=${e}&status=${t}`),updateTicketAsigneeById:async({id:e,user_id:t})=>await En.patch(`/staff/tickets/id/update-asignee?id=${e}&user_id=${t}`),createTicketNote:async({id:e,body:t})=>await En.post(`/staff/tickets/id/create-note?id=${e}`,t)},messages:{getTwilioMessages:async e=>await En.get(`/staff/twilio-messages?ticket_id=${e}`),getTwilioMessageById:async e=>await En.get(`/staff/twilio-messages/id?id=${e}`),createTwilioMessage:async e=>await En.post("/staff/twilio-messages",e),getFbMessages:async e=>await En.get(`/app/facebook-messages?ticket_id=${e}`),getFbMessagesByID:async e=>await En.get(`/app/facebook-messages/id?id=${e}`),createFbMessage:async e=>await En.post("/app/facebook-messages",e)},users:{getUsers:async e=>await En.get("/staff/users",e&&{type:e}),updateStatus:async({status:e})=>await En.patch(`/staff/staffs/update-status/me?status=${e}`)},contacts:{updateTwilioContact:async({id:e,body:t})=>await En.patch(`/staff/twilio-contacts/id?id=${e}`,t)}},assets:{getAssetFileById:async e=>await En.get(`/app/assets/id/file?id=${e}`)},auth:{login:async(e,t)=>await En.post("/app/auth/login",{email:e,password:t}),signUp:async e=>await En.post("/app/auth/sign-up",e),logout:async()=>await En.post("/app/auth/logout")}};var yn=Object(l.c)(e=>({loginPageProps:e.loginPageReducer}),e=>({login(t){e(function({email:e,password:t}){return async a=>{a({type:S,payload:{loadingSubmit:!0}});const n=await fn.auth.login(e,t);if(200!==n.meta.code)return void a({type:T,payload:{meta:n.meta,loadingSubmit:!1}});a({type:w,payload:{loadingSubmit:!1}});const{type:s,admin:o,staff:i}=n.data;localStorage.setItem("app",JSON.stringify({token:n.data.auth.token,type:s,...o&&{admin:o},...i&&{staff:i},last_login:ca()()})),a(Object(dn.d)("/tickets?type=all"))}}(t))},resetPage(){e(async e=>{e({type:_})})},resetMeta(){e(async e=>{e({type:k})})}}))(cn);var bn=a(587),_n=a.n(bn);class kn extends n.Component{render(){const{onTop:e,color:t}=this.props,a={width:60,height:20,zIndex:1,...e&&{position:"absolute",top:"50%",left:"50%",marginTop:-10,marginLeft:-30},...!e&&{margin:"0 auto",paddingTop:150,paddingBottom:100}};return s.a.createElement(_n.a,{color:t,fadeIn:"none",name:"three-bounce",style:a})}}kn.defaultProps={color:"#444",width:60,paddingTop:150,paddingBottom:100};var Sn=kn;class wn extends n.Component{componentDidMount(){this.props.logout()}render(){return s.a.createElement(Sn,null)}}wn.defaultProps={};var Tn=wn;var Cn=Object(l.c)(function(e){return{}},function(e){return{logout(){e(async e=>{const t=await fn.auth.logout();200===t.meta.code&&(localStorage.removeItem("app"),window.location.href=t.data.logout_url)})}}})(Tn);var vn=class extends n.Component{render(){return s.a.createElement("div",null,s.a.createElement("h2",null,"Unauthorized"))}};var In=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"CustomerForm"}))(class extends n.Component{componentWillUnmount(){this.props.reset()}componentDidMount(){}render(){const{registerPageProps:e}=this.props;return s.a.createElement(p.p,null,s.a.createElement(p.p.Section,null,s.a.createElement("div",{style:{width:"50%",margin:"auto",marginBottom:100}},s.a.createElement("center",null,s.a.createElement(p.k,{size:"large",element:"h2"},"We need more information about you."),s.a.createElement(p.k,{size:"small"},"Please fill up the form.")),s.a.createElement("br",null),s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement("p",null,"For Facebook Business Manager ID:",s.a.createElement("br",null),"To locate your Facebook Business Manager ID, click \xa0",s.a.createElement("a",{href:"https://business.facebook.com/settings/info",target:"_blank"},"here"),".",s.a.createElement("br",null),"If you do not have a Facebook Business Manager ID yet, click  \xa0",s.a.createElement("a",{href:"https://www.facebook.com/business/help/1710077379203657",target:"_blank"},"here"),".",s.a.createElement("br",null),"For Business Verification field;",s.a.createElement("br",null),"Check your business information under Business \xa0",s.a.createElement("a",{href:"https://business.facebook.com/settings/info",target:"_blank"},"Verification")," Status.",s.a.createElement("br",null),"For the ",s.a.createElement("a",{href:"https://www.facebook.com/business/help/2058515294227817",target:"_blank"},"Unverified")," account."))),s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement(p.l,null,s.a.createElement(p.m,null,s.a.createElement(en.a,{name:"first_name",label:"First Name*",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"last_name",label:"Last Name*",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"phone_number",label:"Phone Number",component:an}),s.a.createElement(en.a,{name:"email_address",label:"Email Address*",component:an}),s.a.createElement(en.a,{name:"company_name",label:"Company Name*",component:an}),s.a.createElement(en.a,{name:"company_website",label:"Company Website*",component:an}),s.a.createElement(en.a,{name:"company_hq_country",label:"Company HQ Country*",component:an}),s.a.createElement(en.a,{name:"twilio_account_sid",label:"Twilio Account SID*",component:an}),s.a.createElement(en.a,{name:"company_vertical",label:"Company Vertical*",component:an}),s.a.createElement(en.a,{name:"use_case",label:"What is your use case?*",component:an}),s.a.createElement(en.a,{name:"region_sending_messages",label:"Which regions are you sending messages to?*",component:an}),s.a.createElement(en.a,{name:"how_many_messages",label:"How many messages are you sending per month during the first year?*",component:an}),s.a.createElement(en.a,{name:"provision",label:"I wish to provision this account with a third party vendor*",component:an}),s.a.createElement(en.a,{name:"assign_approval",label:"Assign approval to alternate account SID (Optional)*",component:an}),s.a.createElement(en.a,{name:"twilio_can_modify",label:"I understand twilio can modify my SMS/VOICE URL and that approval is only for the brand submitted.*",component:an}),s.a.createElement(en.a,{name:"agree_policies",label:"Do you agree that all information you provide can be used to screen your application and ensure compliance with WhatsApp and Facebook policies?",component:nn,type:"checkbox"}),s.a.createElement(p.f,{primary:!0,fullWidth:!0},"Create Account"))))))))}});var xn=Object(l.c)(e=>({registerPageProps:e.registerPageReducer}),e=>({resetPage(){e(async e=>{e({type:_})})}}))(In);var An=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"RegisterPage"}))(class extends n.Component{constructor(e){super(e),this.state={success:!1}}componentDidUpdate(e){const{meta:t}=e.registerPageProps,{meta:a}=this.props.registerPageProps;if(a&&a!==t){const e={type:200===a.code?"success":"error",...40399===a.code&&{timeout:0}};200===a.code&&this.setState({success:!0}),this.props.alert.show(a.message,e),this.props.resetMeta()}}componentWillUnmount(){this.props.resetPage()}render(){const{pristine:e,submitting:t,invalid:a,loadingSubmit:n}=this.props;return s.a.createElement(p.p,null,s.a.createElement(p.p.Section,null,s.a.createElement("div",{style:{width:"25%",margin:"auto"}},s.a.createElement("br",null),s.a.createElement(p.h,null,s.a.createElement("center",{style:{float:"center",padding:"50px"}},s.a.createElement(p.k,{size:"large",element:"h2"},"Sign up to ",s.a.createElement("span",{style:{color:"#0088ff"}},"anndesk")),s.a.createElement(p.k,{size:"small"},"Enter your details below")),s.a.createElement(p.h.Section,null,s.a.createElement(p.l,{onSubmit:this.props.handleSubmit(e=>this.props.submitPage(e))},s.a.createElement(p.m,null,s.a.createElement(en.a,{name:"name",placeholder:"Full name",component:an,validate:[sn],autoFocus:!0}),s.a.createElement(en.a,{name:"business_name",placeholder:"Business Name",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"mobile_number",placeholder:"Mobile Number",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"industry",placeholder:"Industry",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"email",placeholder:"Email Address",type:"email",component:an,validate:[sn,ln]}),s.a.createElement(en.a,{name:"password",placeholder:"Password",component:an,validate:[sn],type:"password"}),s.a.createElement(en.a,{name:"confirm_password",placeholder:"Confirm Password",component:an,type:"password",validate:[sn]}),s.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center"}},s.a.createElement(Qa.a,{onChange:e=>e.target.checked},s.a.createElement(p.y,null,"Accept",s.a.createElement(ba.a,{style:{textDecoration:"none"},to:"/login"},s.a.createElement("strong",{style:{color:"#09509d"}}," Terms and Conditions"))))),s.a.createElement(p.f,{primary:!0,fullWidth:!0,disabled:e||t||a||n,onClick:this.props.handleSubmit(e=>this.props.submitPage(e))},"Create Account"),s.a.createElement("center",null,s.a.createElement(p.y,null,"Already have an account? \xa0",s.a.createElement(ba.a,{style:{textDecoration:"none"},to:"/login"},s.a.createElement("strong",{style:{color:"#09509d"}},"Sign In")))))))))),s.a.createElement(p.q,{open:this.state.success,onClose:()=>this.setState({success:!1}),title:"Success",primaryAction:{content:"Login",onAction:()=>this.props.history.push("/login")}},s.a.createElement(p.q.Section,null,s.a.createElement(p.w,null,s.a.createElement("p",null,"You have created successfuly your account, you can log in now.")))))}});var Pn=Object(l.c)(e=>({registerPageProps:e.registerPageReducer}),e=>({submitPage(t){var a;e((a=t,async e=>{const{password:t,confirm_password:n}=a;if(t!==n)return e({type:ye,payload:{meta:{code:201,message:"Password did not matched."}}});e({type:be,payload:{loadingSubmit:!0}});const s=await fn.auth.signUp(a);if(200!==s.meta.code)return e({type:ye,payload:{meta:s.meta,loadingSubmit:!1}});e({type:_e,payload:{loadingSubmit:!1,meta:s.meta}})}))},resetPage(){e(async e=>{e({type:fe})})},resetMeta(){e(async e=>{e({type:Ee})})}}))(An);var On=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"ForgotPasswordPage"}))(class extends n.Component{componentWillUnmount(){this.props.reset()}componentDidMount(){}render(){const{forgotPasswordPageProps:e}=this.props;return s.a.createElement(Fa.a,{style:{height:"92vh"},justify:"center",align:"middle"},s.a.createElement("div",{style:{width:"30%",margin:"auto"}},s.a.createElement("br",null),s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement("div",{style:{padding:"1em"}},s.a.createElement("div",{style:{marginBottom:"2em"}},s.a.createElement("span",{style:{fontSize:"1.5em"}},s.a.createElement("strong",null,"Forgot your password?")),s.a.createElement("br",null),s.a.createElement("span",null,"Please enter your email address associated with your account.")),s.a.createElement(p.l,null,s.a.createElement(p.m,null,s.a.createElement(en.a,{name:"email_address",label:"Email Address",component:an}),s.a.createElement(Za.a,{type:"primary",block:!0,style:{background:"#09509d",borderColor:"#09509d"}},"Submit"))))))))}});var Rn=Object(l.c)(e=>({forgotPasswordPageProps:e.forgotPasswordReducer}),e=>({resetPage(){e(async e=>{e({type:_})})}}))(On),Fn=a(440),Mn=a(995),Dn=a(225),Nn=a.n(Dn),jn=a(994),Un=a(993),Bn=a(999),Ln=a(1e3),Gn=a(1001),Hn=a(264),Wn=a.n(Hn),zn=a(251),$n=a(124),qn=a.n($n);const Vn=ca.a;const Kn={chatHeader:{display:"flex",flexDirection:"row",alignItems:"center",padding:"15px",backgroundColor:"#3b5998 ",color:"#f2f2f2",fontWeight:600,borderTopLeftRadius:3,borderTopRightRadius:3},chatHeaderName:{marginLeft:"15px",marginRight:"auto"},chatBubbleHolder:{height:600,backgroundColor:"#f2f2f2",padding:"20px 15px 15px 15px",overflowY:"auto",flexDirection:"column",display:"flex",zIndex:1e3},bgWhite:{backgroundColor:"white"},inputMessage:{color:"#555",width:"100%",border:"0px none",outline:"none",fontSize:"55px !important",resize:"none",height:"50px !important"},chatBottomHolder:{display:"flex",flexDirection:"row",padding:"2px 15px 5px 10px"},pRelative:{position:"relative"},pAbsolute:{position:"absolute",bottom:35},transparentBtn:{backgroundColor:"inherit",border:"0px none",outline:"none"},mLeft:{marginLeft:"auto"},chatBubble:{padding:"10px 13px 15px 15px",width:"250px",backgroundColor:"white",borderRadius:5,boxShadow:"1px 1px #d9d9d9"},dFlex:{display:"flex"},bubbleMessageHolder:{fontSize:"14px",color:"#555",alignSelf:"center",flex:1,lineHeight:1.3,fontWeight:"bold"},tJustify:{textAlign:"left"},bubbleDateHolder:{display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:5},bubbleDate:{fontSize:"11px",color:"#999",fontWeight:600}};var Yn=class extends n.Component{constructor(e){super(e),this.skeletonConversation=(()=>s.a.createElement(p.p,null,s.a.createElement(p.p.Section,null,s.a.createElement(p.h,{sectioned:!0},s.a.createElement(p.w,null,s.a.createElement(p.v,{size:"extraLarge"}),s.a.createElement(p.u,{lines:2}),s.a.createElement(p.u,{lines:4}),s.a.createElement(p.u,{lines:8}),s.a.createElement(p.u,{lines:4})))))),this.socketJoinTicket=(({ticket_id:e,user_id:t,staff_id:a})=>{const{socket:n}=this;n.emit("join_ticket",{ticket_id:e}),n.emit("open_chat",{user_id:t,ticket_id:e,staff_id:a})}),this.socketConnection=(()=>{const{socket:e}=this,{getFbMessagesByID:t,location:a}=this.props,{query:n}=ka()(a.search,!0),{ticket_id:s}=n;e.on("connection",()=>{}),e.on("valid_connection",()=>{e.emit("join_ticket",{ticket_id:s}),this.messagesEnd.scrollIntoView({behavior:"auto"})}),this.socket.on("message",async e=>{e&&(t({message_id:e.facebook_message_id}),this.messagesEnd.scrollIntoView({behavior:"smooth"}))})}),this._chatBubble=(e=>s.a.createElement("div",{style:{display:"flex",margin:"inbound"===e.flow?"15px 20px 15px 0px":"15px 0px 20px 0px",justifyContent:"outbound"===e.flow?"flex-end":null}},s.a.createElement("div",{style:Kn.chatBubble},s.a.createElement("div",{style:Kn.dFlex},s.a.createElement("div",{style:Kn.bubbleMessageHolder},s.a.createElement("p",{style:Kn.tJustify},e.message)),s.a.createElement("div",null,s.a.createElement("button",{className:"fb-chatview-btn",onClick:()=>console.log("Hello World"),style:Kn.transparentBtn},s.a.createElement(p.o,{source:jn.a,color:"skyDark"})))),s.a.createElement("div",{style:Kn.bubbleDateHolder},s.a.createElement("div",null,s.a.createElement("small",{style:Kn.bubbleDate},Vn("outbound"===e.flow?1e3*e.timestamp:e.timestamp).format("hh:mm A"))))))),this._handeMessageValue=(e=>this.setState({messageValue:e})),this._handleEmojiPicked=(e=>this.setState({messageValue:this.state.messageValue.concat(e.emoji)})),this._handleOnClickSend=(e=>this._handleMessageRequest(e)),this._handleMessageRequest=(async e=>{const{messageValue:t,ticket_id:a,file:n}=this.state;t&&"send"===e?await this.props.sendMessageFb({message:t,ticket_id:a}):await this.props.sendMessageFb({message:"\ud83d\udc4d",ticket_id:a}),this.setState({messageValue:"",file:null})}),this.state={messageValue:"",showEmojisPicker:!1,ticket_id:null,loggedIn:null,file:null},this._handleClick=this._handleClick.bind(this),this._handleOutsideClick=this._handleOutsideClick.bind(this),this.socket=Nn()(ma.socket.host,{path:ma.socket.path,forceNew:!0})}componentDidMount(){const{getTicketById:e,getFbMessages:t,getFbMessagesByID:a,getUsers:n,history:s,location:o}=this.props,{query:i}=ka()(o.search,!0),{socket:l}=this,{ticket_id:r}=i;if(!r)return s.push("/tickets?type=all");const c=Na.getLoggedIn(),d=Na.getLoginType();e({ticket_id:r}),t({ticket_id:r}),n(),l.on("connection",()=>{}),l.on("valid_connection",()=>{this.socketJoinTicket({ticket_id:r,user_id:c.user_id||c._id,staff_id:c._id}),setTimeout(()=>{this.messagesEnd&&this.messagesEnd.scrollIntoView({behavior:"auto"})},500)}),this.socket.on("message",async e=>{e&&(a({message_id:e.facebook_message_id}),l.emit("open_chat",{user_id:c.user_id||c._id,ticket_id:r,staff_id:c._id}),this.messagesEnd.scrollIntoView({behavior:"smooth"}))}),this.setState({loggedIn:{...c,loggedInType:d},ticket_id:r})}componentDidUpdate(e){const{location:t,ticketPageProps:a}=e,{location:n,getFbMessages:s,getTicketById:o,ticketPageProps:i}=this.props,{query:l}=ka()(n.search,!0),{query:r}=ka()(t.search,!0),{ticket_id:c}=l;c&&c!==r.ticket_id&&(s({ticket_id:c}),o({ticket_id:c}),this.socketJoinTicket({ticket_id:c}),setTimeout(()=>{this.messagesEnd.scrollIntoView&&this.messagesEnd.scrollIntoView({behavior:"auto"})},500),this.setState({ticket_id:c}))}componentWillUnmount(){this.socket.disconnect(),this.props.resetTicket()}_handleClick(){this.state.showEmojisPicker?document.removeEventListener("click",this._handleOutsideClick,!1):document.addEventListener("click",this._handleOutsideClick,!1),this.setState(e=>({showEmojisPicker:!e.showEmojisPicker}))}_handleOutsideClick(e){this.node.contains(e.target)||this._handleClick()}render(){const{messageValue:e,file:t,loggedIn:a,showEmojisPicker:n}=this.state,{updateTicketStatus:o,ticketPageProps:i}=this.props,{fb_messages:l,ticket:r,loadingSelectedTicket:c,loadingUpdateTicket:d,loadingSendMessage:m,loadingMessages:u}=i,{renderPreviewModal:g,handleSendMessage:h,dropZoneAttachment:E}=this,f=(Da.a.get(r,"twilio_contact.phone"),Da.a.get(r,"twilio_contact.name"),Da.a.get(r,"status")),y=(Da.a.get(a,"loggedInType"),Da.a.get(a,"_id")===Da.a.get(r,"staff_id")),b=y&&!("resolved"===f)&&!(y&&"pending_acceptance"===f),_=l.sort(function(e,t){return Vn.utc(e.created_at).diff(Vn.utc(t.created_at))}),k=_&&Da()(_).groupBy(e=>e&&Vn(e.created_at).format("ddd, D MMM YYYY")).map((e,t)=>({dateTime:t,messages:e})).value();if(c||u)return this.skeletonConversation();const S=[{senderPhoto:"https://picsum.photos/100/100",senderName:"Lee Chan"}];return s.a.createElement(p.h,null,s.a.createElement("div",null,s.a.createElement("div",{style:Kn.chatHeader},s.a.createElement("div",null,s.a.createElement(p.c,{customer:!0,source:S[0].senderPhoto})),s.a.createElement("div",{style:Kn.chatHeaderName},S[0].senderName),s.a.createElement("div",null,s.a.createElement(p.o,{source:Un.a,color:"white"}))),s.a.createElement("div",{style:Kn.chatBubbleHolder},k&&k.map((e,t)=>s.a.createElement(s.a.Fragment,{key:t},s.a.createElement("div",{style:{textAlign:"center",fontSize:11,marginBottom:5,marginTop:5}},e.dateTime),Da.a.get(e,"messages").map((e,t)=>{if(e)return s.a.createElement("div",{key:t},this._chatBubble(e))}))),s.a.createElement("div",{ref:e=>{this.messagesEnd=e},style:{float:"left",clear:"both"}})),b&&s.a.createElement("div",{style:Kn.bgWhite},s.a.createElement("div",null,s.a.createElement(p.x,{placeholder:"Type message...",value:e,onChange:this._handeMessageValue,multiline:!0})),s.a.createElement("div",null,s.a.createElement("div",{style:Kn.chatBottomHolder,ref:e=>{this.node=e}},s.a.createElement("div",null,n?s.a.createElement("div",{style:Kn.pRelative},s.a.createElement("div",{style:Kn.pAbsolute},s.a.createElement(Wn.a,{skinTone:Hn.SKIN_TONE_NEUTRAL,onEmojiClick:(e,t)=>this._handleEmojiPicked(t)}))):null,s.a.createElement("div",null,s.a.createElement("button",{className:"fb-chatview-btn",onClick:this._handleClick,style:Kn.transparentBtn},s.a.createElement(p.o,{source:Bn.a,color:n?"blue":"skyDark"})))),s.a.createElement("div",{style:Kn.mLeft},""===e.trim()?s.a.createElement("button",{className:"fb-chatview-btn",style:Kn.transparentBtn,onClick:()=>this._handleOnClickSend("like")},s.a.createElement(p.o,{source:Ln.a,color:"blue"})):s.a.createElement("button",{className:"fb-chatview-btn",style:Kn.transparentBtn,onClick:()=>this._handleOnClickSend("send")},s.a.createElement(p.o,{source:Gn.a,color:"blue"}))))))))}},Qn=a(604),Jn=a(1011),Zn=a(1016);const Xn={hover:{},parentContainer:{paddingBottom:16,width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},childContainer:{display:"flex",alignItems:"center"}};var es=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={}}render(){const{name:e,_id:t,status:a,img:n,lastMessage:o,date:i,channel:l}=this.props.customer;return s.a.createElement("div",{style:Xn.parentContainer},s.a.createElement("div",{style:Xn.childContainer},s.a.createElement(Oa.b,null,s.a.createElement(Pa.a,{src:n,size:64}),s.a.createElement("div",null,s.a.createElement("h1",{style:{margin:0}},e),s.a.createElement("h2",{style:{color:"grey"}},o)))),s.a.createElement("div",null,s.a.createElement("h1",{style:{margin:0}},i),s.a.createElement("h2",null,l)))}});const{Search:ts}=Qn.a,{Option:as}=Aa.a;const ns={filterBox:{width:"12em"}};var ss=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={test:"Hello World",filters:{customer:"",channel:"",date:""}}}render(){const{filters:e}=this.state,{tickets:t}=this.props.ticketPageProps,a=(t,a)=>{const n=a||"",s=e;switch(t){case"customer":s.customer=n;break;case"channel":s.channel=n;break;case"date":s.date=a.dateString}this.setState({filters:s})},n=s.a.createElement(Oa.b,{direction:"vertical",style:{width:"100%"}},s.a.createElement(ts,{placeholder:"Search Customer",allowClear:!0,onSearch:e=>a("customer",e)}),s.a.createElement(Oa.b,null,s.a.createElement(Jn.a,{placeholder:"Search by Date",format:"MM-DD-YYYY",onChange:(e,t)=>{a("date",{date:e,dateString:t})}}),s.a.createElement(Aa.a,{style:ns.filterBox,allowClear:!0,placeholder:"Search by Channel",onChange:e=>a("channel",e)},s.a.createElement(as,{value:"Messenger"},"Messenger"),s.a.createElement(as,{value:"Instagram"},"Instagram"),s.a.createElement(as,{value:"Email"},"Email"),s.a.createElement(as,{value:"WhatsApp"},"WhatsApp"))));return s.a.createElement(Zn.a,{title:n,style:{width:"100%",marginRight:"16px"}},s.a.createElement("div",null,t.filter(t=>{const a=""===e.customer||t.name.toLowerCase().includes(e.customer.toLowerCase()),n=""===e.channel||t.channel===e.channel,s=""===e.date||t.date===e.date;return a&&n&&s}).map(e=>(e.img="/images/generic_facebook_photo.jpeg",s.a.createElement(es,{key:e._id,customer:e})))))}});const{Title:os}=Ea.a;var is=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={selected:"NON"}}render(){const{selected:e}=this.state;return s.a.createElement(Zn.a,{style:{width:"100%",padding:0,marginRight:"16px"}},s.a.createElement(Fa.a,{style:{height:"80vh"},justify:"center",align:"middle"},s.a.createElement(Oa.b,{direction:"vertical",align:"center"},s.a.createElement(Ja.a,{src:`${za.getImageBasePath()}/images/anndesk-logo.png`,preview:!1,style:{width:"16em",marginBottom:16}}),s.a.createElement(os,{level:3,style:{textAlign:"center"}},"Click the tickets in the left side to start chat here"))))}}),ls=a(1015);var rs=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"ForgotPasswordPage"}))(class extends n.Component{constructor(e){super(e),this.state={selected:"NON"}}render(){const{selected:e}=this.state;return s.a.createElement(Zn.a,{title:"Customer Information",style:{width:"100%",padding:0,marginBottom:"16px"}},s.a.createElement("div",null,s.a.createElement(ls.a,{layout:"vertical",disabled:!0},s.a.createElement(ls.a.Item,{label:"Name"},s.a.createElement(Qn.a,{value:"Joshua Kenan Cinches"})),s.a.createElement(ls.a.Item,{label:"Email"},s.a.createElement(Qn.a,{value:"kenanjoshua3454@gmail.com"})),s.a.createElement(ls.a.Item,{label:"Phone Number"},s.a.createElement(Qn.a,{value:"+639955690227"})))))}});const{Title:cs}=Ea.a,{Option:ds}=Aa.a;var ms=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"ForgotPasswordPage"}))(class extends n.Component{constructor(e){super(e),this.state={selected:"NON",currentStatus:"In Progress",currentPriority:"High"}}render(){const{selected:e,currentStatus:t,currentPriority:a}=this.state;return s.a.createElement(Zn.a,{title:"Ticket Information",style:{width:"100%",padding:0,marginBottom:"1em"}},s.a.createElement("div",null,s.a.createElement(ls.a,{layout:"vertical"},s.a.createElement(ls.a.Item,{label:"Ticket Number"},s.a.createElement(Qn.a,{disabled:!0,value:"001"})),s.a.createElement(ls.a.Item,{label:"Status"},s.a.createElement(Aa.a,{defaultValue:t},s.a.createElement(ds,{value:"Pending"},"Pending"),s.a.createElement(ds,{value:"In Progress"},"In Progress"),s.a.createElement(ds,{value:"Resolved"},"Resolved"))),s.a.createElement(ls.a.Item,{label:"Status"},s.a.createElement(Aa.a,{defaultValue:a},s.a.createElement(ds,{value:"Low"},"Low"),s.a.createElement(ds,{value:"Medium"},"Medium"),s.a.createElement(ds,{value:"High"},"High")))),s.a.createElement(Fa.a,{justify:"space-between"},s.a.createElement(Za.a,{style:{width:"10em"}},"Transfer Ticket"),s.a.createElement(Za.a,{style:{width:"10em",background:"#09509d",borderColor:"#09509d"},type:"primary"},"Save"))))}}),ps=a(1002),us=a(1003);const gs=()=>s.a.createElement(p.p,null,s.a.createElement(p.p.Section,null,s.a.createElement(p.h,{sectioned:!0},s.a.createElement(p.w,null,s.a.createElement(p.v,{size:"extraLarge"}),s.a.createElement(p.u,{lines:8}),s.a.createElement(p.u,{lines:4})))));const hs={container:{marginBottom:10,marginTop:10},noteList:{borderBottom:"1px solid black",marginBottom:5},noteDate:{fontSize:11,color:"#919EAB"}};var Es=Object(tn.a)({form:"TicketInformation"})(class extends n.Component{constructor(e){super(e),this.noteModalHandle=(e=>{this.setState({openNoteModal:e})}),this.customerModalHandle=(e=>{const{ticketPageProps:t}=this.props,{ticket:a}=t;this.props.initialize({name:a.twilio_contact.name}),this.setState({openCustomerInformationModal:e})}),this.renderNoteModal=(()=>{const{pristine:e,submitting:t,invalid:a}=this.props;return s.a.createElement(p.q,{open:this.state.openNoteModal,onClose:()=>this.noteModalHandle(!1),title:"Add note",primaryAction:{content:"Add",onAction:this.props.handleSubmit(e=>[this.props.addTicketNote({fields:e,id:this.state.ticket_id}),this.noteModalHandle(!1)]),disabled:e||t||a},secondaryActions:[{content:"Cancel",onAction:()=>this.noteModalHandle(!1)}]},s.a.createElement(p.q.Section,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(p.l,null,s.a.createElement(p.m,null,s.a.createElement(en.a,{component:an,name:"note",label:"Note",validate:[sn],multiline:!0}))))))}),this.renderCustomerInformationModal=(()=>{const{pristine:e,submitting:t,invalid:a,ticketPageProps:n}=this.props,{ticket:o}=n;return s.a.createElement(p.q,{open:this.state.openCustomerInformationModal,onClose:()=>this.customerModalHandle(!1),title:"Edit Customer Information",primaryAction:{content:"Save",onAction:this.props.handleSubmit(e=>[this.props.updateCustomerInformation({fields:e,id:o.twilio_contact_id}),this.customerModalHandle(!1)]),disabled:e||t||a},secondaryActions:[{content:"Cancel",onAction:()=>this.customerModalHandle(!1)}]},s.a.createElement(p.q.Section,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(p.l,null,s.a.createElement(p.m,null,s.a.createElement(en.a,{component:an,name:"name",label:"Name",value:Da.a.get(o,"twilio_contact.name")}),s.a.createElement(p.x,{label:"Phone Number",disabled:!0,value:Da.a.get(o,"twilio_contact.phone")}))))))}),this.state={ticket_id:"",loggedIn:null,openNoteModal:!1,note:"",openCustomerInformationModal:!1,customerName:""}}componentDidMount(){const{location:e}=this.props,{query:t}=ka()(e.search,!0),{ticket_id:a}=t,n=Na.getLoggedIn(),s=Na.getLoginType();this.setState({loggedIn:{...n,loggedInType:s},ticket_id:a})}componentDidUpdate(e){const{location:t}=e,{location:a}=this.props,{query:n}=ka()(a.search,!0),{query:s}=ka()(t.search,!0),{ticket_id:o}=n;o&&o!==s.ticket_id&&this.setState({ticket_id:o})}render(){const{loggedIn:e,ticket_id:t}=this.state,{updateTicketStatus:a,updateTicketAsignee:n,ticketPageProps:o}=this.props,{users:i,ticket:l,loadingSelectedTicket:r,loadingUpdateTicket:c,loadingMessages:d}=o,m=i&&i.map(e=>({label:e.name,value:e._id})),u=Da.a.get(l,"twilio_contact.phone"),g=Da.a.get(l,"twilio_contact.name"),h=Da.a.get(l,"status"),E=Da.a.get(e,"loggedInType"),f=Da.a.get(e,"_id"),y=Da.a.get(l,"staff_id"),b=Da.a.sortBy(Da.a.get(l,"notes"),function(e){return new ca.a(Da.a.get(e,"created_at"))}).reverse(),_=f===y,k=_&&"pending_acceptance"===h,S="resolved"===h;return r||d?gs():s.a.createElement(s.a.Fragment,null,s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement(p.y,{variation:"subdued"},"Ticket No. "),s.a.createElement(p.w,null,s.a.createElement("p",{style:{fontWeight:"bold",wordWrap:"break-word"}},Da.a.get(l,"_id"))))),s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement(p.y,{variation:"subdued"},"Ticket Status"),s.a.createElement(p.t,{name:"status",labelHidden:!0,options:[{label:"Pending Acceptance",value:"pending_acceptance",disabled:!0},{label:"Pending",value:"pending",disabled:!0},{label:"In progress",value:"in-progress"},{label:"Resolved",value:"resolved"}],value:h,disabled:c||S||"user"===E||!_||k,onChange:e=>{"resolved"===e?window.confirm("Are you sure to resolve this ticket now?")&&a({ticket_id:t,status:e}):a({ticket_id:t,status:e})}}))),"pending"!==h&&s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement(p.y,{variation:"subdued"},"Asignee"),s.a.createElement(p.t,{name:"asignee",labelHidden:!0,options:m,value:Da.a.get(l,"staff_id"),disabled:"user"===E||c||S||!_,onChange:e=>n({ticket_id:t,user_id:e})}))),s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(p.y,{variation:"subdued"},"Customer Information"),_&&!S&&s.a.createElement("span",{onClick:()=>this.customerModalHandle(!0),style:{cursor:"pointer",color:"#006FBB"}},s.a.createElement(p.o,{source:ps.a}))),s.a.createElement("div",null,s.a.createElement(p.y,{variation:"subdued"},"Name: "),s.a.createElement(p.y,{variation:"strong"},g)),s.a.createElement("div",null,s.a.createElement(p.y,{variation:"subdued"},"Phone Number: "),s.a.createElement(p.y,{variation:"strong"},u)))),s.a.createElement(p.h,null,s.a.createElement(p.h.Section,null,s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(p.y,{variation:"subdued"},"Notes"),_&&!S&&s.a.createElement("span",{onClick:()=>this.noteModalHandle(!0),style:{cursor:"pointer",color:"#006FBB"}},s.a.createElement(p.o,{source:us.a}))),b&&b.map((e,t)=>s.a.createElement("div",{style:hs.noteList,key:t},s.a.createElement("span",{style:hs.noteDate},ca()(e.created_at).format("MMM DD, YYYY HH:mm")),s.a.createElement("p",{style:{fontSize:12}},e.note),s.a.createElement("span",{style:{...hs.noteDate,fontStyle:"italic"}},Da.a.get(e,"user.name")))))),this.renderNoteModal(),this.renderCustomerInformationModal())}});const{TabPane:fs}=Fn.a,ys=[{value:"rustic",label:"Rustic"},{value:"antique",label:"Antique"},{value:"vinyl",label:"Vinyl"},{value:"vintage",label:"Vintage"},{value:"refurbished",label:"Refurbished"}];const bs={messagePreview:{whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%",display:"block",overflow:"hidden",fontSize:11,color:"#3596eb"}};var _s=class extends n.Component{constructor(e){super(e),this.joinUserSession=(({user_id:e})=>{const{socket:t}=this;t.emit("join_user_session",{user_id:e})}),this.getTickets=(({type:e})=>{const{query:t}=ka()(this.props.location.search,!0);this.props.getTickets({type:e,ticket_id:t.ticket_id})}),this.handleTabChange=(e=>{this.getTickets({type:this.state.ticketTabs[e].id}),this.setState({selectedTabIndex:e})}),this.renderTicketsTypeBadge=(e=>{let t;return"fb_comment"===e?t=s.a.createElement(p.d,{status:"info",size:"small"},"Facebook Comment"):"whatsapp"===e?t=s.a.createElement(p.d,{status:"success",size:"small"},"WhatsApp Message"):"fb_messenger"===e&&(t=s.a.createElement(p.d,{status:"success",size:"small"},"Facebook Message")),t}),this.renderStatusBadge=(({status:e})=>{let t;return"pending_acceptance"===e?t=s.a.createElement(p.d,{status:"attention",size:"small"},"Pending Acceptance"):"resolved"===e?t=s.a.createElement(p.d,{progress:"complete",size:"small"},"Resolved"):"in-progress"===e?t=s.a.createElement(p.d,{progress:"partiallyComplete",size:"small"},"In Progress"):"pending"===e&&(t=s.a.createElement(p.d,{status:"incomplete",size:"small"},"Pending")),t}),this.renderTicketList=(({tickets:e,loadingTickets:t})=>{const{query:a}=ka()(this.props.location.search,!0);return s.a.createElement(p.s,{loading:t,resourceName:{singular:"staff",plural:"staffs"},items:e,selectedItems:[a.ticket_id],renderItem:e=>{const{_id:t,facebook_contact_id:n,facebook_message:o,twilio_contact:i,twilio_message:l,unread_messages:r,status:c,type:d}=e,m="fb_messenger"===e.type?Da.a.get(n,"phone"):Da.a.get(i,"phone"),u="fb_messenger"===e.type?Da.a.get(o[0],"message"):Da.a.get(l,"message"),g="fb_messenger"===e.type?ca()(Da.a.get(o[0],"timestamp")).format("YYYY-MM-DD"):Da.a.get(l,"date"),h=s.a.createElement(p.c,{name:m,customer:!0});return s.a.createElement("div",null,s.a.createElement(p.r,{id:t,media:h,accessibilityLabel:`View details for ${m}`},s.a.createElement("div",{onClick:()=>this.props.history.push(`/tickets?type=${this.state.ticketTabs[this.state.selectedTabIndex].id}&ticket_id=${t}&ticket_type=${d}`)},s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(p.y,{variation:"strong"},n),s.a.createElement("span",{style:{fontSize:11}},g)),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement("p",{style:bs.messagePreview},u)),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},this.renderTicketsTypeBadge(d),["my","all"].includes(a.type)&&this.renderStatusBadge({status:c}),r>0&&s.a.createElement(p.d,{status:"critical",size:"small"},r)))))}})}),this.updateText=(e=>{const{loading:t,options:a}=this.state;this.setState({searchInputValue:e}),t||this.setState({loading:!0}),setTimeout(()=>{if(""===e)return void this.setState({options:ys,loading:!0});const t=new RegExp(e,"i"),n=a.filter(e=>e.label.match(t));this.setState({options:n,loading:!1})})}),this.updateSelection=(e=>{const t=e.map(e=>{const t=this.state.options.find(t=>t.value.match(e));return t&&t.label});this.setState({selected:e,searchInputValue:t})}),this.state={newTicket:!1,selectedTabIndex:0,options:[],loading:!1,searchInputValue:"",selected:"",ticketTabs:[{id:"my",content:"My Tickets",panelID:"my-tickets"},{id:"unassigned",content:"Unassigned",panelID:"unassigned-tickets"},{id:"resolved",content:"Resolved",panelID:"resolved-tickets"},{id:"all",content:"All",panelID:"all-tickets"}]},this.socket=Nn()(ma.socket.host,{path:ma.socket.path,forceNew:!0})}componentDidMount(){const{query:e}=ka()(this.props.location.search,!0),{history:t,newTicket:a}=this.props,n=this.state.ticketTabs.map(e=>e.id),{type:s,ticket_id:o}=e,{socket:i}=this;n.includes(e.type)?(this.setState({selectedTabIndex:n.indexOf(s)}),o?t.push(`/tickets?type=${s}&ticket_id=${o}`):t.push(`/tickets?type=${s}`),this.getTickets({type:s})):(o?t.push(`/tickets?type=all&ticket_id=${o}`):t.push("/tickets?type=all"),this.getTickets({type:"all"}));const l=Na.getUserId();i.on("connection",()=>{}),i.on("valid_connection",()=>{this.joinUserSession({user_id:l})}),this.socket.on("ticket",async e=>{const{ticket_id:t,user_id:n}=e;console.log({ticket:e});const s=Na.getLoggedIn()._id;console.log({getLoggedInUserId:s}),t&&n===s&&a({ticket_id:e.ticket_id})})}componentDidUpdate(e){const{ticketPageProps:t,location:a}=e,{loadingUpdateTicket:n,loadingNewTicket:s}=t,{ticketPageProps:o}=this.props,{loadingUpdateTicket:i,loadingNewTicket:l,ticket:r}=o,{query:c}=ka()(this.props.location.search,!0),{history:d}=this.props,{query:m}=ka()(a.search,!0),p=this.state.ticketTabs.map(e=>e.id),{ticket_id:u,type:g}=c;(!i&&i!==n||r&&!l&&l!==s)&&(p.includes(c.type)?(this.setState({selectedTabIndex:p.indexOf(g)}),this.getTickets({type:g})):(u?d.push(`/tickets?type=all&ticket_id=${u}`):d.push("/tickets?type=all"),this.getTickets({type:"all"}))),g&&g!==m.type&&(this.setState({selectedTabIndex:p.indexOf(g)}),this.getTickets({type:g}))}componentWillUnmount(){this.socket.disconnect(),this.props.resetTicket()}render(){const{ticketPageProps:e,location:t}=this.props,{selectedTabIndex:a,searchInputValue:n,ticketTabs:o}=this.state,{tickets:i,loadingTickets:l}=e,{query:r}=ka()(t.search,!0);return i&&Da.a.orderBy(i,function(e){return r.ticket_type&&"fb_messenger"===r.ticket_type?new ca.a(Da.a.get(e,"facebook_message.created_at")):r.ticket_type&&"fb_messenger"===r.ticket_type?new ca.a(Da.a.get(e,"twilio_message.created_at")):void 0},["desc"]),p.b.TextField,p.o,Mn.a,s.a.createElement(s.a.Fragment,null,s.a.createElement(Fn.a,{style:{backgroundColor:"white",marginBottom:"1em",padding:20,paddingBottom:0},defaultActiveKey:"1",onChange:e=>{console.log(e)}},s.a.createElement(fs,{tab:"All",key:"1"}),s.a.createElement(fs,{tab:"Assigned",key:"2"}),s.a.createElement(fs,{tab:"Unassigned",key:"3"}),s.a.createElement(fs,{tab:"Resolved",key:"4"})),s.a.createElement("div",{style:{backgroundColor:"#f0f2f5",display:"flex",justifyContent:"space-between"}},s.a.createElement(ss,this.props),s.a.createElement(rn.a,{pageId:"286645431852598",language:"sv_SE",themeColor:"#000000",bottomSpacing:300,loggedInGreeting:"loggedInGreeting",loggedOutGreeting:"loggedOutGreeting",greetingDialogDisplay:"show",debugMode:!0,onMessengerShow:()=>{console.log("onMessengerShow")},onMessengerHide:()=>{console.log("onMessengerHide")},onMessengerDialogShow:()=>{console.log("onMessengerDialogShow")},onMessengerDialogHide:()=>{console.log("onMessengerDialogHide")},onMessengerMounted:()=>{console.log("onMessengerMounted")},onMessengerLoad:()=>{console.log("onMessengerLoad")}}),s.a.createElement(is,null),s.a.createElement("div",{style:{width:"100%"}},s.a.createElement(rs,null),s.a.createElement(ms,null))))}},ks=a(1006),Ss=(a(908),a(1004)),ws=a(1005);const Ts={container:{display:"flex"},bubble:{maxWidth:230,overflowWrap:"break-word",whiteSpace:"pre-wrap",padding:"5px 8px 3px 8px",marginBottom:15,boxShadow:"0 2px 5px 0 rgba(0, 0, 0, 0.2), 0 1px 2px 0 rgba(0, 0, 0, 0.19)",marginLeft:"5px",marginRight:"5px"},message:{margin:0},dateTime:{display:"flex",justifyContent:"flex-end",alignContent:"center",alignItems:"center",color:"#8c8c8c",fontSize:10},mediaContainer:{maxWidth:200,cursor:"pointer"},fileAttachmentContainer:{display:"flex",icon:{padding:10,cursor:"pointer"},fileType:{fontSize:"10px",marginTop:-5},fileName:{fontSize:"15px"}}},Cs=({type:e,file:t,modalHandle:a,filename:n})=>{if(e.includes("image")){if(t)return s.a.createElement("img",{onClick:()=>a(!0),style:Ts.mediaContainer,src:t.remote_url||t.file,alt:e})}else{if(!e.includes("video"))return e.includes("audio")?s.a.createElement("audio",{style:Ts.mediaContainer,controls:!0},s.a.createElement("source",{src:t.remote_url||t.file,type:"audio/mpeg"})):-1!==qn.a.document.indexOf(e)?s.a.createElement("div",{style:Ts.fileAttachmentContainer},s.a.createElement("span",{style:Ts.fileAttachmentContainer.icon,onClick:()=>(({file:e,filename:t})=>{let a=document.createElement("a");a.href=e,a.setAttribute("target","_blank"),a.setAttribute("download",t||"attachment_download"),a.click()})({filename:n,file:t.remote_url||t.file})},s.a.createElement(p.o,{source:ws.a})),s.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},s.a.createElement("span",{style:Ts.fileAttachmentContainer.fileName},n),s.a.createElement("span",{style:Ts.fileAttachmentContainer.fileType},e))):s.a.createElement("span",null,"File not supported.");if(t)return s.a.createElement("video",{style:Ts.mediaContainer,src:t.remote_url||t.file,controls:!0})}};var vs=e=>{const{_id:t,twilio_file_id:a,twilio_file:o,flow:i,created_at:l,message:r,outbound_status:c,loading:d}=e.message,[m,u]=Object(n.useState)(!1);Object(n.useEffect)(()=>{a&&!o&&(async()=>e.getTwilioFileById({message_id:t}))()},[t,d,e,o,a]);const g=e=>{u(e)};return s.a.createElement("div",{style:{...Ts.container,justifyContent:"outbound"===i?"flex-end":"flex-start"}},m&&(e=>s.a.createElement(p.q,{open:m,onClose:()=>g(!1),title:"Attachment Preview",large:!0,secondaryActions:[{content:"Close",onAction:()=>g(!1)}]},s.a.createElement(p.q.Section,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement("img",{src:e.remote_url||e.file,alt:"attached"})))))(o),s.a.createElement("div",{style:{...Ts.bubble,background:"outbound"===i?"#ceff91":"#F4F6F8",borderRadius:"outbound"===i?"10px 10px 0px 10px":"10px 10px 10px 0px"}},d?s.a.createElement(Sn,null):o?s.a.createElement(Cs,{type:o.mime,file:o,modalHandle:g,filename:r}):s.a.createElement("p",{style:Ts.message},r),s.a.createElement("div",{style:Ts.dateTime},s.a.createElement("span",null,ca()(l).format("hh:mm A")),"outbound"===i&&"sending"===c&&s.a.createElement("span",{style:{fontSize:11,width:15,height:15}},s.a.createElement(p.o,{source:Ss.a,color:"inkLighter"})))))};const Is=4,xs=1e6*Is,As=()=>s.a.createElement(p.p,null,s.a.createElement(p.p.Section,null,s.a.createElement(p.h,{sectioned:!0},s.a.createElement(p.w,null,s.a.createElement(p.v,{size:"extraLarge"}),s.a.createElement(p.u,{lines:2}),s.a.createElement(p.u,{lines:4}),s.a.createElement(p.u,{lines:8}),s.a.createElement(p.u,{lines:4})))));const Ps={conversationHeader:{display:"flex",alignItems:"center",height:60,background:"#173630",padding:15,color:"white"},conversation:{height:"400px",display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",paddingTop:20,paddingBottom:20,backgroundImage:`url(${za.getImageBasePath()}/images/bg.png)`},inputContainer:{display:"flex",backgroundColor:"#f1f3f4",borderTop:"0.1px solid #d4d4d4",padding:"5px 0px 0px 0px"},pendingAcceptance:{background:"#173630",padding:5}};var Os=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"TicketList"}))(class extends n.Component{constructor(e){super(e),this.socketJoinTicket=(({ticket_id:e,user_id:t,staff_id:a})=>{const{socket:n}=this;n.emit("join_ticket",{ticket_id:e}),n.emit("open_chat",{user_id:t,ticket_id:e,staff_id:a})}),this.socketConnection=(()=>{const{socket:e}=this,{getTwilioMessageById:t,location:a}=this.props,{query:n}=ka()(a.search,!0),{ticket_id:s}=n;e.on("connection",()=>{}),e.on("valid_connection",()=>{e.emit("join_ticket",{ticket_id:s}),this.messagesEnd.scrollIntoView({behavior:"auto"})}),this.socket.on("message",async e=>{e&&(t({message_id:e.twilio_message_id}),this.messagesEnd.scrollIntoView({behavior:"smooth"}))})}),this.handleChange=(e=>{this.setState({inputText:e})}),this.handleSendMessage=(async()=>{const{inputText:e,ticket_id:t,file:a}=this.state;e?await this.props.sendMessage({message:e,ticket_id:t}):await this.props.sendMessage({ticket_id:t,file:a,filename:a.name,mime:a.type}),this.setState({inputText:"",file:null})}),this.onKeyDownHandle=(e=>{13==e.keyCode&&0==e.shiftKey&&(e.preventDefault(),this.handleSendMessage())}),this.onRejectedAttachFile=(e=>{if(!Da.a.isEmpty(e)){const t=e[0];t&&"file-too-large"===t.errors[0].code&&this.props.alert.show(`File too large. Maximum file size is ${Is} MB`,{type:"error"})}}),this.attachFile=(e=>{e&&this.setState({file:e[0]})}),this.dropZoneAttachment=(()=>s.a.createElement(zn.a,{onDrop:this.attachFile,accept:qn.a.image.concat(qn.a.document).concat(qn.a.video).concat(qn.a.audio).join(","),onDropRejected:this.onRejectedAttachFile,multiple:!1,maxSize:xs},({getRootProps:e,getInputProps:t})=>s.a.createElement("section",{style:{display:"flex",width:"10%",cursor:"pointer",alignItems:"center",justifyContent:"center",marginBottom:5}},s.a.createElement("div",e(),s.a.createElement("input",t()),s.a.createElement(p.o,{source:ks.a,color:"primary"}))))),this.closeAttachmentPreview=(()=>{this.setState({file:""})}),this.renderPreviewModal=(()=>{const{file:e}=this.state,{type:t,name:a}=e;return s.a.createElement(p.q,{open:Boolean(e),onClose:()=>this.closeAttachmentPreview(),title:"Attachment Preview",primaryAction:{content:"Send",onAction:()=>this.handleSendMessage()},secondaryActions:[{content:"Cancel",onAction:()=>this.closeAttachmentPreview()}]},s.a.createElement(p.q.Section,null,s.a.createElement("div",{style:{textAlign:"center"}},t.includes("image")?s.a.createElement("img",{src:URL.createObjectURL(e&&e),alt:e&&e.name,style:{maxWidth:250,maxHeight:250}}):t.includes("video")?s.a.createElement("video",{src:URL.createObjectURL(e),controls:!0,style:{maxWidth:250,maxHeight:250}}):s.a.createElement("p",null,a))))}),this.state={inputText:"",file:null,ticket_id:null,loggedIn:null},this.socket=Nn()(ma.socket.host,{path:ma.socket.path,forceNew:!0})}componentDidMount(){const{getTicketById:e,getTwilioMessages:t,getTwilioMessageById:a,getUsers:n,history:s,location:o}=this.props,{query:i}=ka()(o.search,!0),{socket:l}=this,{ticket_id:r}=i;if(!r)return s.push("/tickets?type=all");const c=Na.getLoggedIn(),d=Na.getLoginType();e({ticket_id:r}),t({ticket_id:r}),n(),l.on("connection",()=>{}),l.on("valid_connection",()=>{this.socketJoinTicket({ticket_id:r,user_id:c.user_id||c._id,staff_id:c._id}),this.messagesEnd&&this.messagesEnd.scrollIntoView({behavior:"auto"})}),this.socket.on("message",async e=>{e&&(a({message_id:e.twilio_message_id}),l.emit("open_chat",{user_id:c.user_id||c._id,ticket_id:r,staff_id:c._id}),this.messagesEnd.scrollIntoView({behavior:"smooth"}))}),this.setState({loggedIn:{...c,loggedInType:d},ticket_id:r})}componentDidUpdate(e){const{location:t,ticketPageProps:a}=e,{location:n,getTwilioMessages:s,getTicketById:o,ticketPageProps:i}=this.props,{query:l}=ka()(n.search,!0),{query:r}=ka()(t.search,!0),{ticket_id:c}=l;c&&c!==r.ticket_id&&(s({ticket_id:c}),o({ticket_id:c}),this.socketJoinTicket({ticket_id:c}),this.messagesEnd.scrollIntoView&&this.messagesEnd.scrollIntoView({behavior:"auto"}),this.setState({ticket_id:c}))}componentWillUnmount(){this.socket.disconnect(),this.props.resetTicket()}render(){const{inputText:e,file:t,loggedIn:a}=this.state,{updateTicketStatus:n,ticketPageProps:o}=this.props,{twilio_messages:i,ticket:l,loadingSelectedTicket:r,loadingUpdateTicket:c,loadingSendMessage:d,loadingMessages:m}=o,{renderPreviewModal:u,handleSendMessage:g,dropZoneAttachment:h}=this,E=Da.a.get(l,"twilio_contact.phone"),f=Da.a.get(l,"twilio_contact.name"),y=Da.a.get(l,"status"),b=(Da.a.get(a,"loggedInType"),Da.a.get(a,"_id")===Da.a.get(l,"staff_id")),_=b&&"pending_acceptance"===y,k=b&&!("resolved"===y)&&!_,S=i&&Da()(i).groupBy(e=>e&&ca()(e.created_at).format("ddd, D MMM YYYY")).map((e,t)=>({dateTime:t,messages:e})).value();return r||m?As():s.a.createElement(p.h,null,s.a.createElement("div",null,s.a.createElement(p.h,null,s.a.createElement("div",{style:Ps.conversationHeader},s.a.createElement(p.c,{name:E,customer:!0}),s.a.createElement("div",{style:{marginLeft:10}},f&&s.a.createElement("span",{style:{fontSize:15}},f),s.a.createElement("span",null,s.a.createElement(p.g,null,E)))),_&&s.a.createElement("div",{style:{width:400,position:"absolute",right:0,top:0,zIndex:999,margin:5}},!c&&s.a.createElement(p.e,{title:"Notification",status:"success",onDismiss:()=>this.props.history.push("/tickets?type=my"),action:{content:"Accept",onAction:()=>n({ticket_id:l._id,status:"in-progress"})}},s.a.createElement("p",null,"New ticket has been assigned to you. Click Accept and start chatting."))),s.a.createElement("div",{style:Ps.conversation},S&&S.map((e,t)=>s.a.createElement(s.a.Fragment,{key:t},s.a.createElement("div",{style:{textAlign:"center",fontSize:11,marginBottom:5,marginTop:5}},e.dateTime),Da.a.get(e,"messages").map((e,t)=>{if(e)return s.a.createElement(vs,{key:t,message:e,getAssetFileById:this.props.getAssetFileById,getTwilioFileById:this.props.getTwilioFileById})}))),s.a.createElement("div",{ref:e=>{this.messagesEnd=e},style:{float:"left",clear:"both"}})),k&&s.a.createElement("div",{style:Ps.inputContainer},s.a.createElement("span",{style:{width:"90%",marginLeft:5}},s.a.createElement("textarea",{type:"text",autoFocus:!0,onChange:e=>this.handleChange(e.target.value),className:"chat-input-text",placeholder:"Send a message",onKeyDown:e=>this.onKeyDownHandle(e),tabIndex:"0",value:e,maxLength:"1600"})),e?s.a.createElement("span",{onClick:()=>!d&&g(),style:{display:"flex",width:"10%",cursor:"pointer",marginBottom:5}},s.a.createElement(p.o,{source:Gn.a,color:"primary"})):h()))),t&&u())}});const Rs=4,Fs=1e6*Rs;const Ms={conversationHeader:{display:"flex",alignItems:"center",height:52,background:"#4267b2",padding:15,color:"white"},inputContainer:{display:"flex",flexDirection:"row",backgroundColor:"#f1f3f4",borderTop:"0.1px solid #d4d4d4",padding:"0px 0px 0px 0px"},pendingAcceptance:{background:"#173630",padding:5},iconSize:{},bgWhite:{backgroundColor:"white"},postDiscription:{fontSize:"14px",fontWeight:"normal",lineHeight:1.38},commentData:{padding:"5px",backgroundColor:"#EEECEC",borderRadius:"18px",display:"flex",flexDirection:"row",justifyContent:"space-between"},senderFrom:{display:"flex",fontSize:12,color:"#0077FC",paddingRight:5},postDetails:{display:"flex",alignItems:"flex-end",flexDirection:"row",justifyContent:"space-around",marginBottom:10,marginTop:100,paddingLeft:10,paddingRight:10},postCommentInput:{display:"flex",flexDirection:"row",justifyContent:"space-around",marginBottom:10,padding:10,borderTop:"2px solid #EEECEC"},avatarPhoto:{float:"left",width:32,height:32},commentInput:{background:"#fff",display:"flex",flexDirection:"row",border:"1px solid #dfe1e5",boxShadow:"none",borderRadius:24,height:30,justifyContent:" space-around",width:"90%",height:"auto",padding:5},commentTextArea:{display:"flex",flexDirection:"row",border:"none",resize:"none",height:40,float:"left",width:"100%",marginLeft:10},agoHolder:{position:"relative"},timeAgo:{position:"absolute",top:-4,fontSize:10,color:"#777"},emojiPicker:{marginTop:50,marginLeft:-200,display:"flex",position:"absolute"}};var Ds=class extends n.Component{constructor(e){super(e),this.handleEmojiPicker=(()=>{const e=this.state.emojipicker;this.setState({emojipicker:!e})}),this.onClickEmoji=((e,t)=>{const a=[...this.state.inputText],n=t.emoji,s=a.concat(n).join("");this.setState({inputText:s})}),this.handleInputChange=(e=>{this.setState({inputText:e})}),this.attachFile=(e=>{e&&this.setState({file:e[0]})}),this.onRejectedAttachFile=(e=>{if(!Da.a.isEmpty(e)){const t=e[0];t&&"file-too-large"===t.errors[0].code&&this.props.alert.show(`File too large. Maximum file size is ${Rs} MB`,{type:"error"})}}),this.handleSendMessage=(async()=>{const{inputText:e,file:t}=this.state;e?await this.props.sendMessage({message:e}):await this.props.sendMessage({file:t,filename:t.name,mime:t.type}),this.setState({inputText:"",file:null})}),this.closeAttachmentPreview=(()=>{this.setState({file:""})}),this.renderPreviewModal=(()=>{const{file:e}=this.state,{type:t,name:a}=e;return s.a.createElement(p.q,{open:Boolean(e),onClose:()=>this.closeAttachmentPreview(),title:"Attachment Preview",primaryAction:{content:"Send",onAction:()=>this.handleSendMessage()},secondaryActions:[{content:"Cancel",onAction:()=>this.closeAttachmentPreview()}]},s.a.createElement(p.q.Section,null,s.a.createElement("div",{style:{textAlign:"center"}},t.includes("image")?s.a.createElement("img",{src:URL.createObjectURL(e&&e),alt:e&&e.name,style:{maxWidth:250,maxHeight:250}}):t.includes("video")?s.a.createElement("video",{src:URL.createObjectURL(e),controls:!0,style:{maxWidth:250,maxHeight:250}}):s.a.createElement("p",null,a))))}),this.dropZoneAttachment=(()=>s.a.createElement(zn.a,{onDrop:this.attachFile,accept:qn.a.image.concat(qn.a.document).concat(qn.a.video).concat(qn.a.audio).join(","),onDropRejected:this.onRejectedAttachFile,multiple:!1,maxSize:Fs},({getRootProps:e,getInputProps:t})=>s.a.createElement("section",{style:{display:"flex",width:"10%",cursor:"pointer",alignItems:"center",justifyContent:"center",marginBottom:5}},s.a.createElement("div",e(),s.a.createElement("input",t()),s.a.createElement(p.o,{source:ks.a,color:"inkLightest"}))))),this.state={fbCommentValue:"",inputText:"",file:null}}render(){const{fbCommentValue:e,inputText:t,file:a}=this.state,n=[{comments:[{profilePhoto:"https://www.gstatic.com/tv/thumb/persons/287557/287557_v9_ba.jpg",created_at:"2020-06-03T08:05:46.311Z",date:"2020-06-03T08:05:43.000Z",flow:"inbound",from:"Lebron James",message:"Has the order shipped already ?"}],PageName:"Facepalm Store",commentDiscription:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",pagePhoto:"https://res.cloudinary.com/grohealth/image/upload/f_auto,fl_lossy,q_auto/v1581678662/DCUK/Content/iStock-959080376.jpg"}];return s.a.createElement(s.a.Fragment,null,s.a.createElement(p.h,null,s.a.createElement("div",{style:Ms.conversationHeader},s.a.createElement(p.c,{customer:!0,source:n[0].pagePhoto}),s.a.createElement("div",{style:{marginLeft:10}},s.a.createElement("span",null,s.a.createElement(p.g,null,n[0].PageName)))),s.a.createElement("div",{style:Ms.bgWhite},s.a.createElement("div",{className:"post-text"},s.a.createElement("div",null,s.a.createElement("p",{style:Ms.postDiscription},s.a.createElement("strong",null,n[0].commentDiscription))))),s.a.createElement("div",null,n[0].comments.map((e,a)=>s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{style:Ms.postDetails},s.a.createElement("span",{style:Ms.avatarPhoto},s.a.createElement("div",null,s.a.createElement(p.c,{customer:!0,source:e.profilePhoto}))),s.a.createElement("div",{style:Ms.commentData},s.a.createElement("span",null,s.a.createElement("strong",{style:Ms.senderFrom},e.from)),s.a.createElement("span",null,s.a.createElement("p",null,e.message)))),s.a.createElement("div",{style:{display:"flex",marginLeft:"15%",marginTop:-10}},s.a.createElement("p",{style:{fontSize:10,color:"#777"}},"2h")),s.a.createElement("div",{style:{height:400}},s.a.createElement("div",{style:Ms.postCommentInput},s.a.createElement("div",{style:{marginRight:10,paddingTop:15,paddingBottom:10}},s.a.createElement("span",{style:Ms.avatarPhoto},s.a.createElement(p.c,{source:n[0].pagePhoto,size:"small"}))),s.a.createElement("div",{style:Ms.commentInput},s.a.createElement("div",{style:{marginLeft:10}},s.a.createElement("span",null,s.a.createElement(p.x,{type:"text",placeholder:"Write a comment...",value:t,onChange:this.handleInputChange,multiline:!0}))),s.a.createElement("span",null,this.state.emojipicker?s.a.createElement("div",{style:Ms.emojiPicker},s.a.createElement(Wn.a,{preload:!0,onEmojiClick:this.onClickEmoji})):""),s.a.createElement("div",{style:{display:"flex",flexDirection:"row",padding:10}},s.a.createElement("div",{onClick:this.handleEmojiPicker,style:{float:"left",width:32,height:32}},s.a.createElement(p.o,{source:Bn.a,color:"inkLightest",size:"small"})),s.a.createElement("div",{style:{float:"left",width:32,height:32,marginLeft:20}},this.dropZoneAttachment()),s.a.createElement("div",{style:{float:"left",width:32,height:32}},s.a.createElement(p.o,{source:Ln.a,color:"inkLightest",size:"small"}))))))))),a&&this.renderPreviewModal()))}};const Ns={instagramCommentHeader:{backgroundColor:"white",padding:"7px 15px 7px 15px",borderBottom:"1px solid #e6e6e6"},avatarAndTitleHolder:{display:"flex",flexDirection:"row",alignItems:"center",padding:8},titleHolder:{marginLeft:15,fontWeight:500,fontSize:"14px"},bgWhite:{backgroundColor:"white"},commentSectionHolder:{padding:30},igPostImage:{width:"100%",borderRadius:1},igPostDescription:{lineHeight:1.4,fontSize:"13px",marginLeft:"3px"},name:{fontSize:12,color:"#333"},userCommentHolder:{marginTop:5,height:"600px"},comment:{marginTop:12,flexDirection:"column",fontSize:"14px"},commentMessage:{fontSize:"13px",marginLeft:"3px"},agoHolder:{position:"relative"},timeAgo:{position:"absolute",top:-4,fontSize:10,color:"#777"},inputHolder:{marginTop:25,flexDirection:"column"},inputBorder:{display:"flex",flexDirection:"row",border:"1px solid #e6e6e6"},textFieldHolder:{marginRight:"auto",flex:1},buttonHolder:{alignSelf:"center",marginRight:"10px"},postBtn:{color:"#33adff",fontWeight:600,backgroundColor:"inherit",outline:"none",border:"none"}};var js=class extends n.Component{constructor(e){super(e),this.handleInstagramCommentValue=(e=>{this.setState({instagramCommentValue:e})}),this.state={instagramCommentValue:""}}render(){const{instagramCommentValue:e}=this.state,t=[{comments:[{created_at:"2020-06-03T08:05:46.311Z",date:"2020-06-03T08:05:43.000Z",flow:"inbound",from:"Cong TV",message:"Hello there jay"},{created_at:"2020-06-03T08:05:46.311Z",date:"2020-06-03T08:05:43.000Z",flow:"outbound",from:"Jay Cruzada",message:"Hello there morlak"},{created_at:"2020-06-03T08:05:46.311Z",date:"2020-06-03T08:05:43.000Z",flow:"inbound",from:"Cong TV",message:"Non amet proident pariatur est non. Laboris aliquip sit nulla enim enim reprehenderit veniam sunt reprehenderit consectetur mollit irure. Reprehenderit adipisicing proident irure consectetur cillum proident incididunt aliquip sint."},{created_at:"2020-06-03T08:05:46.311Z",date:"2020-06-03T08:05:43.000Z",flow:"inbound",from:"Jay Cruzada",message:"Up? naas babaw"}],dateTime:"Wed, 3 June 2020",pagePhoto:"https://picsum.photos/200/300",pagePostedPhoto:"https://picsum.photos/600/600",pageName:"Morlak STORE",description:"Sint nulla ad anim eu ullamco pariatur ullamco aliqua cillum irure aliqua mollit ipsum voluptate. Exercitation aliqua et duis labore veniam do.Nulla aute amet ex consectetur proident magna est mollit cillum enim. Est do elit et mollit dolore. Amet in voluptate id commodo Lorem sint quis culpa sit anim."}];return s.a.createElement(s.a.Fragment,null,s.a.createElement(p.h,null,s.a.createElement("div",{style:Ns.instagramCommentHeader},s.a.createElement("div",{style:Ns.avatarAndTitleHolder},s.a.createElement("div",null,s.a.createElement(p.c,{customer:!0,source:t[0].pagePhoto})),s.a.createElement("div",{style:Ns.titleHolder},t[0].pageName))),s.a.createElement("div",{style:Ns.bgWhite},s.a.createElement("div",{style:Ns.commentSectionHolder},s.a.createElement("div",{className:"ig-post-details"},s.a.createElement("div",{style:{marginBottom:12}},s.a.createElement("img",{src:t[0].pagePostedPhoto,style:Ns.igPostImage})),s.a.createElement("div",null,s.a.createElement("p",{style:Ns.igPostDescription},s.a.createElement("strong",{style:Ns.name},t[0].pageName," "),t[0].description))),s.a.createElement("div",{className:"ig-users-comment",style:Ns.userCommentHolder},s.a.createElement("div",{style:Ns.comment},t[0].comments.map((e,t)=>s.a.createElement(s.a.Fragment,{key:t},s.a.createElement("div",{style:{marginTop:20}},s.a.createElement("div",null,s.a.createElement("strong",{style:Ns.name},e.from," "),s.a.createElement("span",{style:Ns.commentMessage},e.message)),s.a.createElement("div",{style:Ns.agoHolder},s.a.createElement("p",{style:Ns.timeAgo},"2h")))))),s.a.createElement("div",{style:Ns.inputHolder},s.a.createElement("div",{style:Ns.inputBorder},s.a.createElement("div",{className:"textfield-holder",style:Ns.textFieldHolder},s.a.createElement(p.x,{placeholder:"Add comment...",value:e,onChange:this.handleInstagramCommentValue,multiline:!0})),s.a.createElement("div",{style:Ns.buttonHolder},s.a.createElement("button",{className:"ig-post-btn",style:Ns.postBtn},"POST")))))))))}};var Us=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.onAcceptTicket=(()=>{this.setState({showNewTicketAssignedModal:!1,newTicketId:null}),this.props.updateTicketStatus({ticket_id:this.state.newTicketId,status:"in-progress"})}),this.state={showNewTicketAssignedModal:!1,newTicketId:null}}componentDidUpdate(e){const{meta:t,loadingNewTicket:a}=e.ticketPageProps,{meta:n,loadingNewTicket:s,newTicket:o}=this.props.ticketPageProps;if(n&&n!==t){const e={type:200===n.code?"success":"error",...40399===n.code&&{timeout:0}};this.props.alert.show(n.message,e),this.props.resetMeta()}if(o&&!s&&s!==a){const e=Na.getLoggedIn()._id;"pending_acceptance"===o.status&&o.staff_id===e&&this.setState({showNewTicketAssignedModal:!0,newTicketId:o._id})}}render(){const{location:e}=this.props,{showNewTicketAssignedModal:t}=this.state,{query:a}=ka()(e.search,!0);return s.a.createElement(p.p,null,s.a.createElement(p.p.Section,{oneThird:!0},s.a.createElement(_s,this.props)),a.ticket_id&&s.a.createElement(s.a.Fragment,null,s.a.createElement(p.p.Section,{oneThird:!0},a.ticket_type&&"whatsapp"===a.ticket_type&&s.a.createElement(Os,this.props),a.ticket_type&&"ig_comment"===a.ticket_type&&s.a.createElement(js,this.props),a.ticket_type&&"fb_comment"===a.ticket_type&&s.a.createElement(Ds,this.props),a.ticket_type&&"fb_messenger"===a.ticket_type&&s.a.createElement(Yn,this.props)),s.a.createElement(p.p.Section,{oneThird:!0},s.a.createElement(Es,this.props))),t&&s.a.createElement("div",{style:{width:400,position:"absolute",right:0,top:0,zIndex:999,margin:5}},s.a.createElement(p.e,{title:"Notification",status:"success",onDismiss:()=>this.setState({showNewTicketAssignedModal:!1,newTicketId:null}),action:{content:"Accept",onAction:()=>this.onAcceptTicket()}},s.a.createElement("p",null,"New ticket has been assigned to you. Click Accept and start chatting."))))}}),Bs=a(438),Ls=a.n(Bs);const Gs=50;var Hs=Object(l.c)(e=>({ticketPageProps:e.ticketPageReducer}),e=>({sendMessage(t){e(function({ticket_id:e,message:t="",file:a=null,filename:n=null,mime:s=null}){return async(o,i)=>{const{twilio_messages:l,tickets:r}=i().ticketPageReducer,c=[...l],d=a&&await Ls.a.fileToDataUrl(a),m={created_at:new Date,flow:"outbound",message:t,ticket_id:e,...a&&{twilio_file:{file:d,mime:s}},outbound_status:"sending"};c.push(m),o({type:W,payload:{loadingSendMessage:!0,twilio_messages:c}});const p={twilio_message:{ticket_id:e,...!t&&a?{message:n}:{message:t},...a&&{file:d},...n&&{filename:n},...s&&{mime:s}}};let u;if(200!==(u="admin"===Na.getLoginType()?await fn.admin.messages.createTwilioMessage(p):await fn.staff.messages.createTwilioMessage(p)).meta.code)return o({type:$,payload:{loadingSendMessage:!1,meta:u.meta}});const{twilio_messages:g}=i().ticketPageReducer,{twilio_message:h}=u.data,E=[...g],f=r&&r.length>0&&[...r],y=r.findIndex(t=>t._id===e);-1!==y&&(f[y].twilio_message={...h},o({type:z,payload:{tickets:[]}})),E.push(h),o({type:z,payload:{loadingSendMessage:!1,tickets:f}})}}(t))},getTickets(t){e(function({type:e,ticket_id:t}){return async a=>{const n=[`type=${e}`];let s;if(t&&n.push(`ticket_id=${t}`),a(Object(dn.d)(`/tickets?${n.join("&")}`)),a({type:x,payload:{loadingTickets:!0}}),200!==(s="admin"===Na.getLoginType()?await fn.admin.tickets.getTickets({type:e}):await fn.staff.tickets.getTickets({type:e})).meta.code)return a({type:A,payload:{meta:s.meta,loadingTickets:!1}});const{tickets:o}=s.data;a({type:P,payload:{tickets:[]}}),a({type:P,payload:{tickets:o,loadingTickets:!1}})}}(t))},getTwilioMessages(t){e(function({ticket_id:e}){return async t=>{let a;if(t({type:q,payload:{loadingMessages:!0}}),200!==(a="admin"===Na.getLoginType()?await fn.admin.messages.getTwilioMessages(e):await fn.staff.messages.getTwilioMessages(e)).meta.code)return t({type:K,payload:{loadingMessages:!1,meta:a.meta}});const{twilio_messages:n}=a.data;t({type:V,payload:{loadingMessages:!1,twilio_messages:n}})}}(t))},getTwilioMessageById(t){e(function({message_id:e}){return async(t,a)=>{const{twilio_messages:n}=a().ticketPageReducer;let s;if(t({type:te}),200!==(s="admin"===Na.getLoginType()?await fn.admin.messages.getTwilioMessageById(e):await fn.staff.messages.getTwilioMessageById(e)).meta.code)return t({type:ae,payload:{meta:s.meta}});const{twilio_message:o}=s.data,i=[...n],l=n.findIndex(e=>e._id===o._id);if(-1===l){const e=i[i.length-1];"outbound"===e.flow&&"sending"===e.outbound_status?i[i.length-1]={...o}:i.push(o)}else i[l]={...o};t({type:ne,payload:{twilio_messages:i}})}}(t))},getTicketById(t){e(function({ticket_id:e}){return async(t,a)=>{const{tickets:n}=a().ticketPageReducer;let s;if(t({type:L,payload:{loadingSelectedTicket:!0}}),200!==(s="admin"===Na.getLoginType()?await fn.admin.tickets.getTicketById(e):await fn.staff.tickets.getTicketById(e)).meta.code)return t(Object(dn.d)("/tickets?type=all")),t({type:G,payload:{loadingSelectedTicket:!1,meta:s.meta}});const{ticket:o}=s.data,i=n&&n.length>0&&[...n],l=n.findIndex(t=>t._id===e);-1!==l&&(i[l].unread_messages=0,t({type:H,payload:{tickets:[]}})),t({type:H,payload:{loadingSelectedTicket:!1,ticket:o,...n.length>0&&{tickets:i},showNewTicketAssignedModal:"pending_acceptance"===o.status&&o.staff_id===Na.getLoggedIn()._id}})}}(t))},newTicket(t){e(function({ticket_id:e}){return async(t,a)=>{const{tickets:n}=a().ticketPageReducer;let s;if(t({type:se,payload:{loadingTickets:!0,loadingNewTicket:!0}}),200!==(s="admin"===Na.getLoginType()?await fn.admin.tickets.getTickets({ticket_id:e}):await fn.staff.tickets.getTickets({ticket_id:e})).meta.code)return t({type:oe,payload:{meta:s.meta,loadingTickets:!1,loadingNewTicket:!1}});const{tickets:o}=s.data,i=o[0],l=n&&n.length>0?[...n]:[],r=l.findIndex(t=>t._id===e);-1===r?(t({type:ie,payload:{tickets:[]}}),l.push(i)):l[r]={...i},t({type:ie,payload:{loadingTickets:!1,loadingNewTicket:!1,newTicket:i}}),t({type:ie,payload:{newTicket:null}})}}(t))},getTwilioFileById(t){e(function({message_id:e}){return async(t,a)=>{const{twilio_messages:n}=a().ticketPageReducer,s=[...n],o=s.findIndex(t=>t._id===e&&t.twilio_file_id&&!t.twilio_file);let i;if(-1!==o&&(s[o].loading=!0),t({type:te,payload:{twilio_messages:s}}),200!==(i="admin"===Na.getLoginType()?await fn.admin.messages.getTwilioMessageById(e):await fn.staff.messages.getTwilioMessageById(e)).meta.code)return t({type:ae,payload:{meta:i.meta}});const{twilio_message:l}=i.data,{twilio_messages:r}=a().ticketPageReducer,c=[...r],d=n.findIndex(e=>e._id===l._id&&e.twilio_file_id&&!e.twilio_file);-1!==d&&(c[d]={...l},l.twilio_file?c[d].loading=!1:c[d].retry>=Gs?c[d].loading=!1:(c[d].loading=!0,c[d].retry=c[d].retry+1,c[d].loading=!0)),t({type:ne,payload:{twilio_messages:c}})}}(t))},updateTicketAsignee(t){e(function({ticket_id:e,user_id:t}){return async(a,n)=>{const{ticket:s}=n().ticketPageReducer;let o;if(a({type:O,payload:{loadingUpdateTicket:!0}}),200!==(o="staff"===Na.getLoginType()?await fn.staff.tickets.updateTicketAsigneeById({id:e,user_id:t}):await fn.admin.tickets.updateTicketAsigneeById({id:e,user_id:t})).meta.code)return a({type:R,payload:{meta:o.meta,loadingUpdateTicket:!1}});const{ticket:i}=o.data;a({type:F,payload:{meta:o.meta,loadingUpdateTicket:!1,ticket:{...s,...i}}}),a(Object(dn.d)("/tickets?type=my"))}}(t))},updateTicketStatus(t){e(function({ticket_id:e,status:t}){return async(a,n)=>{const{tickets:s,ticket:o}=n().ticketPageReducer;let i;if(a({type:M,payload:{loadingUpdateTicket:!0}}),200!==(i="staff"===Na.getLoginType()?await fn.staff.tickets.updateTicketStatusById({id:e,status:t}):await fn.admin.tickets.updateTicketStatusById({id:e,status:t})).meta.code)return a({type:D,payload:{loadingUpdateTicket:!1,meta:i.meta}});const{ticket:l}=i.data,r=[...s],c=r.findIndex(t=>t._id===e);-1!==c&&(r[c]={...r[c],...l}),a({type:N,payload:{meta:i.meta,loadingUpdateTicket:!1,tickets:r,ticket:{...o,...l}}}),"in-progress"===t&&a(Object(dn.d)(`/tickets?type=my&ticket_id=${l._id}`))}}(t))},updateCustomerInformation(t){e(function({fields:e,id:t}){return async(a,n)=>{const{ticket:s}=n().ticketPageReducer;a({type:de,payload:{loadingUpdateTicket:!0}});const o={twilio_contact:{...e}};let i;if(200!==(i="staff"===Na.getLoginType()?await fn.staff.contacts.updateTwilioContact({body:o,id:t}):await fn.admin.contacts.updateTwilioContact({body:o,id:t})).meta.code)return a({type:me,payload:{loadingUpdateTicket:!1,meta:i.meta}});const{twilio_contact:l}=i.data;a({type:pe,payload:{ticket:{...s,twilio_contact:{...l}},loadingUpdateTicket:!1,meta:i.meta}})}}(t))},addTicketNote(t){e(function({id:e,fields:t}){return async(a,n)=>{const{ticket:s}=n().ticketPageReducer;a({type:ce,payload:{loadingUpdateTicket:!0}});const o={note:{note:t.note}};let i;if(200!==(i="staff"===Na.getLoginType()?await fn.staff.tickets.createTicketNote({body:o,id:e}):await fn.admin.tickets.createTicketNote({body:o,id:e})).meta.code)return a({type:le,payload:{loadingUpdateTicket:!1,meta:i.meta}});const{ticket:l}=i.data;a({type:re,payload:{ticket:{...s,...l},loadingUpdateTicket:!1,meta:i.meta}})}}(t))},getUsers(){e(async e=>{let t;if(e({type:X,payload:{loadingUsers:!0}}),200!==(t="admin"===Na.getLoginType()?await fn.admin.users.getUsers():await fn.staff.users.getUsers()).meta.code)return e({type:Z,payload:{loadingUsers:!1}});const{users:a}=t.data;e({type:ee,payload:{loadingUsers:!1,users:a}})})},resetTicket(){e(async e=>{e({type:B})})},resetMeta(){e(async e=>{e({type:j})})},resetPage(){e(async e=>{e({type:U})})},getFbMessages(t){e(function({ticket_id:e}){return async t=>{let a;if(t({type:wt,payload:{loadingMessages:!0}}),200!==(a="admin"===Na.getLoginType()?await fn.admin.messages.getFbMessages(e):await fn.staff.messages.getFbMessages(e)).meta.code)return t({type:Ct,payload:{loadingMessages:!1,meta:a.meta}});const{facebook_messages:n}=a.data;t({type:Tt,payload:{loadingMessages:!1,fb_messages:n}})}}(t))},getFbMessagesByID(t){e(function({message_id:e}){return async(t,a)=>{const{fb_messages:n}=a().ticketPageReducer;let s;if(t({type:vt}),200!==(s="admin"===Na.getLoginType()?await fn.admin.messages.getFbMessagesByID(e):await fn.staff.messages.getFbMessagesByID(e)).meta.code)return t({type:It,payload:{meta:s.meta}});const{facebook_message:o}=s.data,i=[...n],l=n.findIndex(e=>e._id===o._id);if(-1===l){const e=i[i.length-1];"outbound"===e.flow&&"sending"===e.outbound_status?i[i.length-1]={...o}:i.push(o)}else i[l]={...o};t({type:xt,payload:{fb_messages:i}})}}(t))},sendMessageFb(t){e(function({ticket_id:e,message:t="",file:a=null,filename:n=null,mime:s=null}){return async(o,i)=>{const{fb_messages:l,tickets:r}=i().ticketPageReducer;console.log("testing",i().ticketPageReducer);const c=[...l],d=a&&await Ls.a.fileToDataUrl(a),m={created_at:new Date,flow:"outbound",message:t,ticket_id:e,...a&&{fb_file:{file:d,mime:s}},outbound_status:"sending"};c.push(m),o({type:_t,payload:{loadingSendMessage:!0,fb_messages:c}});const p={facebook_message:{ticket_id:e,...!t&&a?{message:n}:{message:t},...a&&{file:d},...n&&{filename:n},...s&&{mime:s},facebook_page_id:l[0].facebook_page_id,user_id:l[0].user_id,facebook_connection_id:l[0].facebook_connection_id,facebook_contact_id:l[0].facebook_contact_id,facebook_chat_id:l[0].facebook_chat_id}};let u;if(200!==(u="admin"===Na.getLoginType()?await fn.admin.messages.createFbMessage(p):await fn.staff.messages.createFbMessage(p)).meta.code)return o({type:St,payload:{loadingSendMessage:!1,meta:u.meta}});const{fb_messages:g}=i().ticketPageReducer,{facebook_message:h}=u.data,E=[...g],f=r&&r.length>0&&[...r],y=r.findIndex(t=>t._id===e);-1!==y&&(f[y].facebook_message={...h},o({type:z,payload:{tickets:[]}})),E.push(h),o({type:kt,payload:{loadingSendMessage:!1,tickets:f}})}}(t))}}))(Us),Ws=a(1007);var zs=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"AccountDetailsForm"}))(class extends n.Component{componentDidMount(){this.props.initialize({...this.props.data})}render(){const{pristine:e,submitting:t,invalid:a,isOpen:n,modalHandle:o,updateAccount:i,loadingSubmit:l}=this.props;return s.a.createElement(p.h,null,s.a.createElement(p.q,{open:n,onClose:()=>o("accountDetails",!1),title:"Account Information",primaryAction:{content:"Save",disabled:e||t||a||l,onAction:this.props.handleSubmit(e=>i(e))},size:"Full"},s.a.createElement(p.q.Section,null,s.a.createElement(p.l,{onSubmit:this.props.handleSubmit(e=>i(e))},s.a.createElement(p.m,null,s.a.createElement(en.a,{name:"details.business_name",label:"Company Name",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"name",label:"Business owner's name",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"details.mobile_number",label:"Mobile Number",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"email",label:"Email Address (Username)",component:an,validate:[sn,ln]}),s.a.createElement(en.a,{name:"old_password",label:"New Password",component:an,type:"password"}),s.a.createElement(en.a,{name:"password",label:"Confirm Password",component:an,type:"password"}))))))}});var $s=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"StaffForm"}))(class extends n.Component{componentDidUpdate(e){const{loadingStaffModal:t}=e,{loadingStaffModal:a,staffFormType:n}=this.props;t&&t!==a&&"updating"===n&&this.props.initialize({...this.props.data})}render(){const{data:e,pristine:t,submitting:a,invalid:n,loadingStaffModal:o,loadingSubmit:i,isOpen:l,submitStaff:r,modalHandle:c,staffFormType:d}=this.props;return s.a.createElement(p.h,null,s.a.createElement(p.q,{open:l,onClose:e=>c("staffForm",!1),title:"adding"===d?"Add Staff":"Update Staff",primaryAction:{content:"Save",disabled:t||a||n||i,onAction:this.props.handleSubmit(t=>r({...t,selectedStaff:e}))},size:"Full"},s.a.createElement(p.q.Section,null,o?s.a.createElement(Sn,null):s.a.createElement(p.l,{onSubmit:this.props.handleSubmit(t=>r({...t,selectedStaff:e}))},s.a.createElement(p.m,null,s.a.createElement(en.a,{name:"name",label:"Full Name",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"email",label:"Email Address",component:an,validate:[sn,ln]}),s.a.createElement(en.a,{name:"old_password",label:"Password",component:an,validate:"adding"===d&&[sn],type:"password"}),s.a.createElement(en.a,{name:"password",label:"Confirm Password",validate:"adding"===d&&[sn],component:an,type:"password"}))))))}}),qs=a(589),Vs=a.n(qs);var Ks=Object(h.d)(Object(tn.a)({form:"TwilioConnectionForm"}))(class extends n.Component{componentDidUpdate(e){const{loadingTwilioForm:t}=e,{loadingTwilioForm:a}=this.props;t&&t!==a&&this.props.initialize({...this.props.data})}render(){const{data:e,loadingTwilioForm:t,isOpen:a,modalHandle:n,submitTwilioConnection:o,invalid:i,twilioFormType:l}=this.props;return s.a.createElement(p.h,null,s.a.createElement(p.q,{open:a,onClose:()=>n("twilioConnectionForm",!1),title:"adding"===l?"Add WhatsApp Connection":"Edit WhatsApp Connection",primaryAction:{content:"Save",disabled:i,onAction:this.props.handleSubmit(t=>o({...t,selectedTwilio_connection:e}))}},s.a.createElement(p.q.Section,null,t?s.a.createElement(Sn,null):s.a.createElement(p.l,{onSubmit:this.props.handleSubmit(t=>o({...t,selectedTwilio_connection:e}))},s.a.createElement(p.m,null,s.a.createElement(en.a,{name:"name",label:"Connection Name",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"enabled",label:"Enabled Status",component:nn,type:"checkbox"}),s.a.createElement(en.a,{name:"account_sid",label:"Account SID",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"auth_token",label:"Account Token",component:an,validate:[sn]}))))))}});var Ys=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"ConnectionForm"}))(class extends n.Component{constructor(e){super(e),this.triggerFacebookLogin=(()=>s.a.createElement(Vs.a,{appId:ma.facebook.app_id,fields:"name",scope:"pages_show_list,pages_messaging,pages_manage_metadata,pages_manage_engagement,pages_messaging",callback:e=>{console.log({response:e}),e.accessToken&&(this.closeModal(),this.props.addFacebokConnection({...e}))}})),this.closeModal=(()=>{this.props.modalHandle("connectionForm",!1)}),this.handleTwilioModal=(()=>{this.props.handleTwilioModal(!0),this.closeModal()}),this.state={selected:"facebook",triggerFacebookLogin:!1,successFacebookLogin:!1}}componentDidMount(){}statusChangeCallback(e){console.log("statusChangeCallback"),console.log(e),"connected"===e.status?(this.loggedIn(e),console.log(this.state)):(e.status,this.loggedOut(),console.log(this.state.loggedStatus))}render(){const{selected:e}=this.state,{loadingSubmit:t,isOpen:a}=this.props;return s.a.createElement(p.h,null,s.a.createElement(p.q,{open:a,onClose:e=>this.closeModal(),title:"Select Connection",primaryAction:{content:"Close",disabled:t,onAction:()=>this.closeModal()},secondaryActions:"whatsapp"===e?{content:"Okay",onAction:()=>this.handleTwilioModal()}:null,size:"Full"},s.a.createElement(p.q.Section,null,t?s.a.createElement(Sn,null):s.a.createElement(p.l,null,"facebook"===e&&this.triggerFacebookLogin(),s.a.createElement(p.m,null,s.a.createElement(p.j,{choices:[{label:"Facebook",value:"facebook"},{label:"WhatsApp",value:"whatsapp"},{label:"Instagram",value:"instagram"},{label:"WeChat",value:"wechat"}],selected:this.state.selected,onChange:e=>this.setState({selected:e[0]})}))))))}});var Qs={staffStatus(e){switch(e){case"online":return"Online";case"offline":return"Offline"}return""},connectionType(e){switch(e){case"facebook":return{title:"Facebook",description:"Create tickets from Facebook messages and comments."};case"whatsapp":return{title:"WhatsApp",description:"Create tickets from WhatsApp messages"}}return{title:"",description:""}},staffStatus(e){switch(e){case"active":return"Active";case"inactive":return"Inactve";default:return e}}};const Js={container:{display:"flex",justifyContent:"space-between"},connectionsContainer:{},connectionHeader:{padding:10,display:"flex",width:"100%",justifyContent:"space-between",borderBottom:"1px solid black"}};var Zs=class extends n.Component{constructor(...e){super(...e),this.renderFacebookConnections=(e=>{const t=({type:e,status:t,facebook_connection_id:a,facebook_page_id:n})=>{window.confirm(`Are you sure to ${t?"enable":"disable"} this feature?`)&&this.props.updatePageSubcribedFieldById({type:e,status:t,facebook_connection_id:a,facebook_page_id:n})};return s.a.createElement(p.s,{loading:!1,resourceName:{singular:"connection",plural:"connections"},items:e,renderItem:e=>{const{_id:a,facebook_pages:n}=e,o=Qs.connectionType("facebook");return s.a.createElement(p.r,{id:a},s.a.createElement("div",{style:Js.connectionsContainer},s.a.createElement("div",{style:Js.connectionHeader},s.a.createElement("div",null,s.a.createElement(p.y,{variation:"strong"},o.title),s.a.createElement(p.g,null,o.description)),s.a.createElement("div",{style:{display:"flex"}},s.a.createElement(p.o,{source:Ws.a,color:"red"}))),n.length<0?s.a.createElement("span",null,"display TBD"):n.map(e=>{const{loadingSubcribedFieldUpdate:n}=this.props,{_id:o,name:i,subscribed_fields:l}=e,r=s.a.createElement(p.c,{size:"small",name:i,initials:i.charAt(0)});return s.a.createElement(p.r,{media:r,key:o},s.a.createElement("div",null,s.a.createElement(p.y,{variation:"strong"},i)),s.a.createElement("div",null,s.a.createElement(p.i,{disabled:n,label:"Enable Messenger",checked:l.messages,onChange:e=>t({type:"messages",status:e,facebook_connection_id:a,facebook_page_id:o})}),s.a.createElement("br",null),s.a.createElement(p.i,{disabled:n,label:"Enable Facebook Comments",checked:l.feed,onChange:e=>t({type:"feed",status:e,facebook_connection_id:a,facebook_page_id:o})})))})))}})})}render(){const{loadingFacebookConnections:e,facebook_connections:t,loadingSubmitFacebookConnection:a}=this.props;return s.a.createElement("div",{style:{width:600}},e||a?s.a.createElement(Sn,null):t.length<=0?s.a.createElement("div",{style:{textAlign:"center",marginTop:10}},s.a.createElement(p.y,{variation:"strong"},"No facebook connection found.")):this.renderFacebookConnections(t))}},Xs=a(1008),eo=({hovered:e=!1,Webhook:t})=>s.a.createElement("td",{style:{display:"flex",flexDirection:"row",textAlign:"left"}},s.a.createElement("div",null,e?s.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},s.a.createElement("u",{style:{color:"#afb4b7"}},t),s.a.createElement("span",null,s.a.createElement(p.o,{source:Xs.a,color:"inkLightest"}))):s.a.createElement("div",null,t)));const to={container:{display:"flex",justifyContent:"space-between"},connectionsContainer:{},connectionHeader:{padding:10,display:"flex",width:"100%",justifyContent:"space-between",borderBottom:"1px solid black"}};var ao=class extends n.Component{constructor(e){super(e),this.handleMouseEnter=(e=>{const t=this.state.data.slice().map(t=>t.account_sid===e?{...t,hovered:!0}:{...t});this.setState({data:t})}),this.handleMouseLeave=(e=>{const t=this.state.data.slice().map(t=>t.account_sid===e?{...t,hovered:!1}:{...t});this.setState({data:t})}),this.handledata=(e=>{const t=this.state.mousehover;return s.a.createElement("div",null,t?s.a.createElement("div",null,s.a.createElement("a",null,e),s.a.createElement("span",null,s.a.createElement(p.o,{source:Xs.a}))):s.a.createElement("div",null,e))}),this.handleClickedData=(e=>{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}),this.handleTwilioConnectionId=(async e=>{await this.props.getTwilioConnectionById({id:e}),this.props.modalHandle("twilioConnectionForm",!0,e)}),this.renderTwilioConnections=(e=>{const{handledata:t}=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{style:to.connectionHeader},s.a.createElement("div",{style:{display:"flex"}},s.a.createElement(p.y,{variation:"strong"},"WhatsApp Connection List"))),s.a.createElement(p.s,{loading:!1,resourceName:{singular:"connection",plural:"connections"},items:e,renderItem:(e,t,a)=>{const{_id:n,name:o,enabled:i,account_sid:l,auth_token:r}=e,c=window.btoa(`${l}:${r}`),d=i?"enabled":"disabled",m=c.length>10?c.substring(0,17)+"...":c;let u=!1;return this.state.data.length&&(u=this.state.data[a].hovered),s.a.createElement("div",{key:u,style:to.connectionsContainer,onMouseEnter:()=>setTimeout(()=>{this.handleMouseEnter(l)},0),onMouseLeave:()=>setTimeout(()=>{this.handleMouseLeave(l)},0)},s.a.createElement(p.h,null,s.a.createElement(p.r,null,s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"}},s.a.createElement("table",{style:{flexDirection:"column",width:560,padding:10}},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",{style:{textAlign:"left"}},s.a.createElement(p.y,{variation:"subdued"},"Connection Name: ")),s.a.createElement("td",{style:{textAlign:"left"}},s.a.createElement(p.y,{variation:"strong"},o))),s.a.createElement("tr",null,s.a.createElement("td",{style:{textAlign:"left"}},s.a.createElement(p.y,{variation:"subdued"},"Status: ")),s.a.createElement("td",{style:{textAlign:"left"}},s.a.createElement(p.y,{variation:"strong"},d))),s.a.createElement("tr",null,s.a.createElement("td",{style:{textAlign:"left"}},s.a.createElement(p.y,{variation:"subdued"},"Webhook route: ")),s.a.createElement("div",{onClick:()=>this.handleClickedData(c)},s.a.createElement(eo,{Webhook:m,hovered:u}))))),s.a.createElement("div",{onClick:()=>this.handleTwilioConnectionId(n),style:{display:"flex",alignItems:"center"}},s.a.createElement("span",{style:{marginRight:10}},s.a.createElement(p.o,{source:ps.a,color:"primary"})))))))}}))}),this.state={mousehover:!1,hoverdata:"",data:[]}}componentDidUpdate(e){const{loadingTwilioData:t}=e,{loadingTwilioData:a,twilioFormType:n}=this.props;t&&t!==a&&"updating"===n&&this.props.initialize({...this.props.twilio_connections}),this.props.twilio_connections.length&&e.twilio_connections.length!==this.props.twilio_connections.length&&this.setState({data:this.props.twilio_connections.map(({account_sid:e})=>({hovered:!1,account_sid:e}))})}render(){const{twilio_connections:e,loadingTwilioConnections:t}=this.props;return s.a.createElement("div",{style:{width:600}},t?s.a.createElement(Sn,null):e.length<=0?s.a.createElement("div",{style:{textAlign:"center",marginTop:10}},s.a.createElement(p.y,{variation:"strong"},"No twilio connection found.")):this.renderTwilioConnections(e))}};const no={container:{display:"flex",justifyContent:"space-between"},staffListContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"}};var so=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.modalHandle=(async(e,t,a="")=>{"accountDetails"===e?this.setState({accountDetailsForm:t}):"connectionForm"===e?this.setState({connectionForm:t}):"twilioConnectionForm"===e?this.setState({twilioConnectionForm:t,twilioFormType:a?"updating":"adding"}):(a&&await this.props.getStaffById({id:a}),t||this.props.resetSelectedStaff(),this.setState({staffForm:t,staffFormType:a?"updating":"adding"}))}),this.onDeleteStaff=(({e:e,_id:t})=>{e.stopPropagation(),t&&window.confirm("Are you sure to delete this staff?")&&this.props.deleteStaff({id:t})}),this.state={accountDetailsForm:!1,staffForm:!1,connectionForm:!1,staffFormType:null,twilioConnectionForm:!1,twilioFormType:null}}componentDidMount(){this.props.getAccount(),this.props.getFacebookConnections(),this.props.getTwilioConnections()}componentDidUpdate(e){const{meta:t,loadingSubmitFacebookConnection:a,loadingTwilioData:n}=e.settingsPageProps,{meta:s,loadingSubmitFacebookConnection:o,loadingTwilioData:i}=this.props.settingsPageProps;s&&s!==t&&200===s.code&&this.setState({accountDetailsForm:!1,staffForm:!1,staffFormType:null,twilioFormType:null}),i||i===n||(this.modalHandle("twilioConnectionForm",!1),this.props.getTwilioConnections()),o||o===a||this.props.getFacebookConnections()}componentWillUnmount(){this.props.resetPage()}render(){const{loadingTwilioData:e,settingsPageProps:t,submitStaff:a,submitTwilioConnection:n,addFacebokConnection:o,updatePageSubcribedFieldById:i,getTwilioConnectionById:l}=this.props,{loadingDelete:r,staffs:c,selectedStaff:d,loadingSubmitFacebookConnection:m,loadingStaffs:u,loadingFacebookConnections:g,facebook_connections:h,twilio_connections:E,loadingTwilioForm:f,loadingSubcribedFieldUpdate:y,loadingStaffModal:b,loadingSubmit:_,loadingAccount:k}=t,{details:S,email:w,name:T}=Da.a.get(t,"account")||"",{business_name:C,industry:v,mobile_number:I}=S||"",{accountDetailsForm:x,staffForm:A,connectionForm:P,staffFormType:O,twilioConnectionForm:R,twilioConnectionId:F,twilioFormType:M}=this.state;return s.a.createElement(p.p,null,s.a.createElement(p.p.Section,null,s.a.createElement("hr",null),x&&T&&s.a.createElement(zs,{modalHandle:this.modalHandle,isOpen:x,data:Da.a.get(t,"account"),updateAccount:this.props.updateAccount,loadingSubmit:_}),A&&s.a.createElement($s,{modalHandle:this.modalHandle,loadingStaffModal:b,staffFormType:O,isOpen:A,data:d,submitStaff:a,loadingSubmit:_}),R&&s.a.createElement(Ks,{modalHandle:this.modalHandle,twilioFormType:M,loadingTwilioForm:f,isOpen:R,submitTwilioConnection:n,data:Da.a.get(t,"selectedTwilio_connection")}),P&&s.a.createElement(Ys,{modalHandle:this.modalHandle,isOpen:P,loadingSubmit:_,addFacebokConnection:o,twilioConnectionId:F}),s.a.createElement("div",{style:no.container},s.a.createElement(p.n,null,"My account"),s.a.createElement(p.h,{title:"Account Details",sectioned:!0,primaryFooterAction:{content:"Edit Information",onClick:()=>this.modalHandle("accountDetails",!0),disabled:k||_}},s.a.createElement("table",{style:{width:560}},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(p.y,{variation:"subdued"},"Company Name: ")),s.a.createElement("td",null,s.a.createElement(p.y,{variation:"strong"},C))),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(p.y,{variation:"subdued"},"Business owner's Name: ")),s.a.createElement("td",null,s.a.createElement(p.y,{variation:"strong"},T))),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(p.y,{variation:"subdued"},"Mobile Number: ")),s.a.createElement("td",null,s.a.createElement(p.y,{variation:"strong"},I))),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(p.y,{variation:"subdued"},"Email Address: ")),s.a.createElement("td",null,s.a.createElement(p.y,{variation:"strong"},w))),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(p.y,{variation:"subdued"},"Password: ")),s.a.createElement("td",null,s.a.createElement(p.y,{variation:"strong"},"**************")))))))),s.a.createElement(p.p.Section,null,s.a.createElement("hr",null),s.a.createElement("div",{style:no.container},s.a.createElement(p.n,null,"Connections"),s.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},s.a.createElement(p.h,{primaryFooterAction:{content:"Add Connection",onClick:()=>this.modalHandle("connectionForm",!0),disabled:g||m}},s.a.createElement(Zs,{facebook_connections:h,loadingSubcribedFieldUpdate:y,loadingFacebookConnections:g,loadingSubmitFacebookConnection:m,updatePageSubcribedFieldById:i})),s.a.createElement(p.h,{primaryFooterAction:{content:"Add Connection",onClick:()=>this.modalHandle("twilioConnectionForm",!0)}},s.a.createElement(ao,{twilioFormType:M,modalHandle:this.modalHandle,twilio_connections:E,getTwilioConnectionById:l,loadingTwilioData:e}))))),s.a.createElement(p.p.Section,null,s.a.createElement("hr",null),s.a.createElement("div",{style:no.container},s.a.createElement(p.n,null,"List of Staffs"),s.a.createElement(p.h,{primaryFooterAction:{content:"Add Staff Account",onClick:()=>this.modalHandle("staffForm",!0),disabled:u||_}},s.a.createElement("div",{style:{width:600}},u?s.a.createElement(Sn,null):c.length<=0?s.a.createElement("div",{style:{textAlign:"center",marginTop:10}},s.a.createElement(p.y,{variation:"strong"},"No staff found.")):s.a.createElement(p.s,{loading:!1,resourceName:{singular:"staff",plural:"staffs"},items:c,renderItem:e=>{const{_id:t,name:a,status:n}=e,o=s.a.createElement(p.c,{size:"small",name:a,initials:a.charAt(0)});return s.a.createElement("div",null,s.a.createElement(p.r,{id:t,media:o,accessibilityLabel:`View details for ${a}`},s.a.createElement("div",{onClick:()=>!r&&!b&&!_&&this.modalHandle("staffForm",!0,t),style:no.staffListContainer},s.a.createElement("div",null,s.a.createElement("h1",null,a),s.a.createElement(p.y,{variation:"strong"},a),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(p.y,{variation:"subdued"},s.a.createElement(p.d,{status:n&&"offline"!==n?"success":"critical"},Qs.staffStatus(e.status||"offline"))))),s.a.createElement("div",{style:{display:"flex"}},s.a.createElement("span",{style:{marginRight:10}},s.a.createElement(p.o,{source:ps.a,color:"primary"})),s.a.createElement("span",{onClick:e=>!r&&!b&&!_&&this.onDeleteStaff({e:e,_id:t})},s.a.createElement(p.o,{source:Ws.a,color:"red"}))))))}}))))))}});function oo(){return async e=>{e({type:Ae,payload:{loadingAccount:!0}});const t=await fn.admin.accounts.getAccount();if(200!==t.meta.code)return e({type:Pe,payload:{meta:t.meta,loadingAccount:!1}});const{user:a}=t.data;e({type:Oe,payload:{loadingAccount:!1,account:a}}),e(io())}}function io(){return async e=>{e({type:Ve,payload:{loadingStaffs:!0}});const t=await fn.admin.users.getUsers("staff");if(200!==t.meta.code)return e({type:Ke,payload:{loadingStaffs:!1}});const{users:a}=t.data;e({type:Ye,payload:{loadingStaffs:!1,staffs:a}})}}function lo({id:e}){return async t=>{t({type:Qe,payload:{loadingStaffModal:!0}});const a=await fn.admin.users.getStaffById(e);if(200!==a.meta.code)return t({type:Je,payload:{loadingStaffModal:!1}});const{staff:n}=a.data;t({type:Ze,payload:{loadingStaffModal:!1,selectedStaff:n}})}}function ro(e){return async(t,a)=>{const{staffs:n}=a().settingsPageReducer,{selectedStaff:s}=e,{password:o,old_password:i}=e;if(o!==i)return t({type:nt,payload:{meta:{code:201,message:"Password did not matched."}}});t({type:at,payload:{loadingSubmit:!0}});const l={staff:{...e}};let r;if(s?(l.staff.updated_at=s.updated_at,r=await fn.admin.users.updateStaffById(s._id,l)):r=await fn.admin.users.createStaff(l),200!==r.meta.code)return t({type:nt,payload:{loadingSubmit:!1,meta:r.meta}});const{staff:c}=r.data;let d={loadingSubmit:!1,meta:r.meta};if(s){d.selectedStaff=null;const e=[...n],t=e.findIndex(e=>e._id===c._id);e[t]={...c},d.staffs=e}else d.staffs=[...n,c];t({type:st,payload:d})}}function co({id:e}){return async(t,a)=>{const{staffs:n}=a().settingsPageReducer;if(t({type:Xe,payload:{loadingDeleteStaff:!0}}),200!==(await fn.admin.users.deleteStaffById(e)).meta.code)return t({type:et,payload:{loadingDeleteStaff:!1}});const s=[...n],o=s.findIndex(t=>t._id===e);s.splice(o,1),t({type:tt,payload:{loadingDeleteStaff:!1,staffs:s}})}}function mo(){return async e=>{e({type:rt})}}function po(){return async e=>{e({type:Re})}}function uo(){return async e=>{e({type:Fe})}}var go=Object(l.c)(e=>({settingsPageProps:e.settingsPageReducer}),e=>({getAccount(){e(oo())},updateAccount(t){var a;e((a=t,async e=>{const{password:t,old_password:n}=a;if(t!==n)return e({type:Ie,payload:{meta:{code:201,message:"Password did not matched."}}});e({type:ve,payload:{loadingSubmit:!0}});const{mobile_number:s,industry:o,business_name:i}=a.details,l=await fn.admin.accounts.updateAccount({...a,mobile_number:s,business_name:i,industry:o});if(200!==l.meta.code)return e({type:Ie,payload:{loadingSubmit:!1,meta:l.meta}});const{user:r}=l.data;localStorage.setItem("app",JSON.stringify({...JSON.parse(localStorage.getItem("app")),user:r})),e({type:xe,payload:{loadingSubmit:!1,account:r,meta:l.meta}})}))},getStaffById(t){e(lo(t))},submitStaff(t){e(ro(t))},deleteStaff(t){e(co(t))},resetSelectedStaff(){e(mo())},addFacebokConnection(t){e(function({accessToken:e,userID:t,name:a}){return async n=>{n({type:mt,payload:{loadingSubmitFacebookConnection:!0}});const s={facebook_connection:{access_token:e,facebook_user_name:a,facebook_user_id:t}},o=await fn.admin.connections.facebook.createFacebookConnection(s);if(200!==o.meta.code)return n({type:ut,payload:{loadingSubmitFacebookConnection:!1,meta:o.meta}});n({type:pt,payload:{loadingSubmitFacebookConnection:!1,meta:o.meta}})}}(t))},getFacebookConnections(t){e(async e=>{e({type:ht,payload:{loadingFacebookConnections:!0}});const t=await fn.admin.connections.facebook.getFacebookConnections();if(200!==t.meta.code)return e({type:gt,payload:{loadingFacebookConnections:!1,meta:t.meta}});const{facebook_connections:a}=t.data;e({type:Et,payload:{loadingFacebookConnections:!1,facebook_connections:a}})})},updatePageSubcribedFieldById(t){e(function({facebook_page_id:e,facebook_connection_id:t,status:a,type:n}){return async(s,o)=>{s({type:ft,payload:{loadingSubcribedFieldUpdate:!0}});const i={facebook_page:{facebook_connection_id:t,status:a,type:n}},l=await fn.admin.connections.facebook.updatePageSubcribedFieldById({id:e,body:i});if(200!==l.meta.code)return s({type:yt,payload:{loadingSubcribedFieldUpdate:!1,meta:l.meta}});const{facebook_page:r}=l.data,{facebook_connections:c}=o().settingsPageReducer,d=[...c],m=c.findIndex(e=>e._id===r.facebook_connection_id);if(-1!==m){const e=c[m].facebook_pages.findIndex(e=>e._id===r._id);-1!==e&&(s({type:bt,payload:{facebook_connections:[]}}),d[m].facebook_pages[e].subscribed_fields={...r.subscribed_fields})}s({type:bt,payload:{meta:l.meta,loadingSubcribedFieldUpdate:!1,facebook_connections:d}})}}(t))},submitTwilioConnection(t){var a;e((a=t,async(e,t)=>{const{twilio_connections:n}=t().settingsPageReducer,{selectedTwilio_connection:s}=a;console.log(s),e(s?{type:Ut,payload:{loadingTwilioData:!0}}:{type:At,payload:{loadingTwilioData:!0}});const{name:o,_id:i,account_sid:l,auth_token:r,enabled:c}=a,d={twilio_connection:{name:o,_id:i,account_sid:l,auth_token:r,enabled:c}};let m;const p=i;if(200!==(m=s?await fn.admin.twilioconnections.twilio.updateTwilioConnectionById({id:p,body:d}):await fn.admin.twilioconnections.twilio.createTwilioConnection(d)).meta.code)return e(s?{type:Lt,payload:{loadingTwilioData:!1,metta:m.meta}}:{type:Ot,payload:{loadingTwilioData:!1,meta:m.meta}});const{twilio_connection:u}=m.data;let g={loadingTwilioData:!1,meta:m.meta};if(s){const e=[...n],t=e.findIndex(e=>e.id===u._id);e[t]={...u},g.twilio_connections=e}else g.twilio_connections=[...n,u];e({type:Bt,payload:g})}))},getTwilioConnections(t){e(async e=>{e({type:Rt,payload:{loadingTwilioConnections:!0}});const t=await fn.admin.twilioconnections.twilio.getTwilioConnections();if(200!==t.meta.code)return e({type:ae,payload:{loadingTwilioConnections:!1,meta:t.meta}});const{twilio_connections:a}=t.data;e({type:Mt,payload:{loadingTwilioConnections:!1,twilio_connections:a}})})},getTwilioConnectionById(t){e(function({id:e}){return async t=>{t({type:Nt,payload:{loadingTwilioForm:!0}});const a=await fn.admin.twilioconnections.twilio.getTwilioConnectionById(e);if(200!==a.meta.code)return t({type:Dt,payload:{loadingTwilioForm:!1}});const{twilio_connection:n}=a.data;t({type:jt,payload:{loadingTwilioForm:!1,selectedTwilio_connection:n}})}}(t))},resetPage(){e(po())},resetMeta(){e(uo())}}))(so),ho=a(235),Eo=a(607),fo=a(606),yo=a(605),bo=a(1010);var _o=Object(h.d)(Object(c.b)(),Object(tn.a)({form:"StaffForm"}))(class extends n.Component{componentDidUpdate(e){const{loadingStaffModal:t}=e,{loadingStaffModal:a,staffFormType:n}=this.props;t&&t!==a&&"updating"===n&&this.props.initialize({...this.props.data})}render(){const{data:e,pristine:t,submitting:a,invalid:n,loadingStaffModal:o,loadingSubmit:i,isOpen:l,submitStaff:r,modalHandle:c,staffFormType:d}=this.props;return s.a.createElement(p.h,null,s.a.createElement(p.q,{open:l,onClose:e=>c(!1),title:"adding"===d?"Add Staff":"Update Staff",primaryAction:{content:"Save",disabled:t||a||n||i,onAction:this.props.handleSubmit(t=>r({...t,selectedStaff:e}))},size:"Full"},s.a.createElement(p.q.Section,null,o?s.a.createElement(Sn,null):s.a.createElement(p.l,{onSubmit:this.props.handleSubmit(t=>r({...t,selectedStaff:e}))},s.a.createElement(p.m,null,s.a.createElement(en.a,{name:"name",label:"Full Name",component:an,validate:[sn]}),s.a.createElement(en.a,{name:"email",label:"Email Address",component:an,validate:[sn,ln]}),s.a.createElement(en.a,{name:"old_password",label:"Password",component:an,validate:"adding"===d&&[sn],type:"password"}),s.a.createElement(en.a,{name:"password",label:"Confirm Password",validate:"adding"===d&&[sn],component:an,type:"password"}))))))}});var ko=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.modalHandle=(async(e,t="")=>{t&&await this.props.getStaffById({id:t}),e||this.props.resetSelectedStaff(),this.setState({staffForm:e,staffFormType:t?"updating":"adding"})}),this.state={statusValue:"All",searchValue:"",staffForm:!1,staffFormType:null,data:[]}}componentDidMount(){this.props.getStaffs()}componentDidUpdate(e){const{meta:t,loadingSubmitFacebookConnection:a,loadingTwilioData:n}=e.settingsPageProps,{meta:s,loadingSubmitFacebookConnection:o,loadingTwilioData:i}=this.props.settingsPageProps;s&&s!==t&&200===s.code&&this.setState({staffForm:!1,staffFormType:null})}componentWillUnmount(){this.props.resetPage()}render(){const{settingsPageProps:e,submitStaff:t}=this.props,{staffs:a,selectedStaff:n,loadingStaffModal:o,loadingSubmit:i}=e,{statusValue:l,searchValue:r,staffForm:c,staffFormType:d}=this.state,m=[{title:"Staff ID",dataIndex:"staffID",key:"staffID",render:e=>e},{title:"Name",dataIndex:"name",key:"name"},{title:"Status",key:"tags",dataIndex:"tags",render:(e,{tags:t})=>s.a.createElement(s.a.Fragment,null,t.map(e=>{let t="online"===e?"green":"volcano";return s.a.createElement(fo.a,{color:t,key:e},e.toUpperCase())}))},{title:"Action",key:"action",render:(e,t)=>s.a.createElement(Oa.b,{size:"middle"},s.a.createElement(Za.a,{type:"link",onClick:()=>this.props.navigateToDetailsPage(t._id)},"Edit"))}],p=a.map((e,t)=>(e.tags=[],e.status||(e.status="offline"),e.tags.push(e.status),e.staffID=e._id,e.key=t+1,e)),u=[{label:"All",key:"1"},{label:"Online",key:"2"},{label:"Offline",key:"3"}],g=s.a.createElement(ya.a,{onClick:e=>{yo.b.info(`${u[e.key-1].label}`),this.setState({statusValue:u[e.key-1].label})},items:u}),{Search:h}=Qn.a;return s.a.createElement("div",{style:{width:"95%",margin:"auto"}},s.a.createElement(Zn.a,{title:"Staff List"},c&&s.a.createElement(_o,{modalHandle:this.modalHandle,loadingStaffModal:o,staffFormType:d,isOpen:c,data:n,submitStaff:t,loadingSubmit:i}),s.a.createElement(Oa.b,{direction:"vertical",size:"middle",style:{display:"flex"}},s.a.createElement(Fa.a,{justify:"end"},s.a.createElement(Oa.b,null,s.a.createElement(Ra.a,{overlay:g},s.a.createElement(Za.a,null,s.a.createElement(Oa.b,null,l,s.a.createElement(ho.a,null)))),s.a.createElement(h,{placeholder:"Search by Staff ID, Name",allowClear:!0,onSearch:e=>{yo.b.info(e),this.setState({searchValue:e})},style:{width:200}}),s.a.createElement(Za.a,{type:"primary",icon:s.a.createElement(Eo.a,null),style:{backgroundColor:"#09509d",borderColor:"#09509d"},onClick:()=>this.props.navigateToAddPage()},"New Staff"))),s.a.createElement(bo.a,{dataSource:("All"===l?p:p.filter(e=>e.tags[0].toLowerCase()===l.toLowerCase())).filter(e=>{const t=e.staffID.toLowerCase()+e.name.toLowerCase(),a=r.toLowerCase();return t.includes(a)}),columns:m}))))}});var So=Object(l.c)(e=>({settingsPageProps:e.settingsPageReducer}),e=>({getAccount(){e(oo())},getStaffById(t){e(lo(t))},submitStaff(t){e(ro(t))},deleteStaff(t){e(co(t))},resetSelectedStaff(){e(mo())},getStaffs(){e(async e=>{e({type:Ve,payload:{loadingStaffs:!0}});const t=await fn.admin.users.getStaffs();if(200!==t.meta.code)return e({type:Ke,payload:{loadingStaffs:!1}});const{staffs:a}=t.data;e({type:Ye,payload:{loadingStaffs:!1,staffs:a}})})},navigateToDetailsPage(t){e(function(e){return async t=>{t(Object(dn.d)(`/staffs/id/basic?id=${e}`))}}(t))},navigateToAddPage(){e(async e=>{e(Object(dn.d)("/staffs/create"))})},resetPage(){e(po())},resetMeta(){e(uo())}}))(ko),wo=a(1018);var To=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={}}render(){const e={data:[{month:"January",tickets:38},{month:"February",tickets:52},{month:"March",tickets:61},{month:"April",tickets:145},{month:"May",tickets:89},{month:"June",tickets:232},{month:"July",tickets:49},{month:"August",tickets:121},{month:"September",tickets:72},{month:"October",tickets:178},{month:"November",tickets:89},{month:"December",tickets:98}],xField:"month",yField:"tickets",label:{position:"middle",style:{background:"red",fill:"#FFFFFF",opacity:1}},xAxis:{label:{autoHide:!0,autoRotate:!1}},meta:{type:{alias:"month"},sales:{alias:"tickets"}}};return s.a.createElement(Zn.a,{style:{width:"70%",marginRight:16},title:s.a.createElement(()=>s.a.createElement(Oa.b,{style:{display:"flex",justifyContent:"space-between"}},"Tickets",s.a.createElement(Jn.a,{defaultValue:ca()("2022"),picker:"year",allowClear:!1})),null)},s.a.createElement(wo.a,e))}});const Co={parentContainer:{marginBottom:"1em",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},childContainer:{display:"flex",alignItems:"center"}};var vo=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={}}render(){const{name:e,_id:t,status:a,img:n}=this.props.staff;return s.a.createElement("div",{style:Co.parentContainer},s.a.createElement("div",{style:Co.childContainer},s.a.createElement(Oa.b,null,s.a.createElement(Pa.a,{src:n,size:64}),s.a.createElement("div",null,s.a.createElement("h1",{style:{margin:0}},e),s.a.createElement("h2",null,"Staff ID: ",t)))),s.a.createElement("div",null,a))}});const Io={parentDiv:{width:"100%",height:"27em",overflow:"hidden",position:"relative"},childDiv:{position:"absolute",top:0,bottom:0,left:0,right:"-17px",overflowY:"scroll"}};var xo=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={}}render(){const{staffs:e}=this.props;return s.a.createElement(Zn.a,{title:"Staff List",style:{width:"30%"}},s.a.createElement("div",{style:Io.parentDiv},s.a.createElement("div",{style:Io.childDiv},e.map(e=>(e.img=`https://waifu.vercel.app/sfw/waifu?random=${Math.floor(200*Math.random())}`,s.a.createElement(vo,{key:e._id,staff:e}))))))}});const{Option:Ao}=Aa.a;const Po={searchBox:{width:"12em"}};var Oo=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={filters:{status:"",priority:"",channel:"",date:""}}}render(){const{tickets:e}=this.props,{filters:t}=this.state,a=[{title:"Ticket ID",dataIndex:"key",key:"key",render:e=>s.a.createElement("a",null,e)},{title:"Customer",dataIndex:"customer",key:"key"},{title:"Channel",dataIndex:"channel",key:"key"},{title:"Date",dataIndex:"date",key:"key"},{title:"Priority",dataIndex:"priority",key:"key"},{title:"Staff",dataIndex:"name",key:"key"},{title:"Status",dataIndex:"status",key:"key"}],n=(e,a)=>{const n=a||"",s=t;switch(e){case"status":s.status=n;break;case"priority":s.priority=n;break;case"channel":s.channel=n;break;case"date":s.date=a.dateString}this.setState({filters:s})};return s.a.createElement(Zn.a,{title:"List"},s.a.createElement(Oa.b,{direction:"vertical",size:"middle",style:{display:"flex"}},s.a.createElement(Fa.a,{justify:"end"},s.a.createElement(Oa.b,null,s.a.createElement(Aa.a,{style:Po.searchBox,allowClear:!0,placeholder:"Search by Status",onChange:e=>n("status",e)},s.a.createElement(Ao,{value:"Pending"},"Pending"),s.a.createElement(Ao,{value:"In Progress"},"In Progress"),s.a.createElement(Ao,{value:"Resolved"},"Resolved")),s.a.createElement(Aa.a,{style:Po.searchBox,allowClear:!0,placeholder:"Search by Priority",onChange:e=>n("priority",e)},s.a.createElement(Ao,{value:"Low"},"Low"),s.a.createElement(Ao,{value:"Medium"},"Medium"),s.a.createElement(Ao,{value:"High"},"High")),s.a.createElement(Aa.a,{style:Po.searchBox,allowClear:!0,placeholder:"Search by Channel",onChange:e=>n("channel",e)},s.a.createElement(Ao,{value:"Messenger"},"Messenger"),s.a.createElement(Ao,{value:"Instagram"},"Instagram"),s.a.createElement(Ao,{value:"Email"},"Email"),s.a.createElement(Ao,{value:"WhatsApp"},"WhatsApp")),s.a.createElement(Jn.a,{placeholder:"Search by Date",format:"MM-DD-YYYY",onChange:(e,t)=>{n("date",{date:e,dateString:t})}}))),s.a.createElement(bo.a,{dataSource:e.filter(e=>{const a=""===t.status||e.status===t.status,n=""===t.priority||e.priority===t.priority,s=""===t.channel||e.channel===t.channel,o=""===t.date||e.date===t.date;return a&&n&&s&&o}),columns:a})))}});const{Text:Ro,Title:Fo,Paragraph:Mo}=Ea.a;const Do={mainHeader:{paddingLeft:"35em",paddingRight:"35em",display:"flex",justifyContent:"center",alignItems:"center",height:"60em",width:"100%"}};var No=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={}}render(){return s.a.createElement(Fa.a,{style:{height:"82vh"},justify:"center",align:"middle"},s.a.createElement(Zn.a,{style:Do.mainHeader},s.a.createElement(Ea.a,null,s.a.createElement(Oa.b,{direction:"vertical",align:"center"},s.a.createElement(Ja.a,{src:`${za.getImageBasePath()}/images/caution.svg`,preview:!1}),s.a.createElement(Fo,{level:2},"Account Pending"),s.a.createElement(Mo,{style:{fontSize:18}},"Your account is pending for approval. We will send out an email notification once your account is ready. For the mean time, please setup your Staff accounts in the ",s.a.createElement("span",{style:{fontWeight:"bold"}},"Settings")," page."),s.a.createElement(Za.a,{size:"large",style:{background:"#f9e45b",borderColor:"#f9e45b",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"}},s.a.createElement(ba.a,{to:"/settings",style:{width:"10em"}},s.a.createElement("strong",{style:{color:"black"}},"Go to Settings")))))))}});const jo={container:{display:"flex",justifyContent:"space-between",marginBottom:16}};var Uo=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={pending:!1}}componentDidMount(){this.props.getAccount()}componentWillUnmount(){this.props.resetPage()}render(){const{staffListProps:e}=this.props,{pending:t}=this.state,{staffs:a}=e,n=[{key:"001",customer:"Jim Halpert",channel:"Messenger",date:"06-10-2022",priority:"Medium",name:"Jane Doe",status:"Pending"},{key:"002",customer:"John Doe",channel:"Instagram",date:"06-09-2022",priority:"Medium",name:"Jet Lee",status:"In Progress"},{key:"003",customer:"Maria Georgies",channel:"Email",date:"06-08-2022",priority:"High",name:"Michael Scott",status:"Resolved"}];return s.a.createElement("div",null,t?s.a.createElement(No,null):s.a.createElement("div",{style:jo.mainContainer},s.a.createElement("div",{style:jo.container},s.a.createElement(To,{tickets:n}),s.a.createElement(xo,{staffs:a})),s.a.createElement(Oo,{tickets:n})))}});function Bo(){return async e=>{e({type:Ae,payload:{loadingAccount:!0}});const t=await fn.admin.accounts.getAccount();if(200!==t.meta.code)return e({type:Pe,payload:{meta:t.meta,loadingAccount:!1}});const{user:a}=t.data;e({type:Oe,payload:{loadingAccount:!1,account:a}}),e(async e=>{e({type:Ve,payload:{loadingStaffs:!0}});const t=await fn.admin.users.getStaffs();if(200!==t.meta.code)return e({type:Ke,payload:{loadingStaffs:!1}});const{staffs:a}=t.data;e({type:Ye,payload:{loadingStaffs:!1,staffs:a}})})}}var Lo=Object(l.c)(e=>({staffListProps:e.staffListReducer}),e=>({getAccount(){e(Bo())},resetPage(){e(async e=>{e({type:Re})})},resetMeta(){e(async e=>{e({type:Fe})})}}))(Uo),Go=a(1024);const{Search:Ho}=Qn.a,{Option:Wo}=Aa.a;const zo={searchBox:{width:"12em"}};var $o=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={pages:[],filters:{status:"",search:"",date:""}}}componentDidMount(){this.props.getReports()}componentWillUnmount(){this.props.resetPage()}render(){const{filters:e}=this.state,{reportPageProps:t}=this.props,{reports:a}=t,n=[{title:"Ticket ID",dataIndex:"_id",key:"key"},{title:"Assignee",dataIndex:"assignee",key:"key"},{title:"Date",dataIndex:"date",key:"key"},{title:"Status",dataIndex:"status",key:"key"},{title:"Action",dataIndex:"action",key:"key",render:(e,t)=>s.a.createElement(Za.a,{type:"link",icon:s.a.createElement(Go.a,null),ghost:!0,onClick:()=>l(i(t),`report-${t._id}`)})}],o=(t,a)=>{const n=a||"",s=e;switch(t){case"status":s.status=n;break;case"search":s.search=n;break;case"date":s.date=a.dateString}this.setState({filters:s})},i=e=>{const t=[],a=Object.keys(e);t.push(a.join(","));const n=Object.values(e).join(",");return t.push(n),t.join("\n")},l=(e,t)=>{const a=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(a),s=document.createElement("a");s.setAttribute("href",n),s.setAttribute("download",`${t}.csv`),s.click()};return s.a.createElement("div",{style:{width:"95%",margin:"auto"}},s.a.createElement(Zn.a,{title:"Reports List"},s.a.createElement(Oa.b,{direction:"vertical",size:"middle",style:{display:"flex"}},s.a.createElement(Fa.a,{justify:"end"},s.a.createElement(Oa.b,null,s.a.createElement(Aa.a,{style:zo.searchBox,allowClear:!0,placeholder:"Search by Status",onChange:e=>o("status",e)},s.a.createElement(Wo,{value:"Not Started"},"Not Started"),s.a.createElement(Wo,{value:"In Progress"},"In Progress"),s.a.createElement(Wo,{value:"Resolved"},"Resolved")),s.a.createElement(Jn.a,{placeholder:"Search by Date",format:"MM-DD-YYYY",onChange:(e,t)=>{o("date",{date:e,dateString:t})}}),s.a.createElement(Ho,{placeholder:"Search by Ticket ID, Assignee",allowClear:!0,onSearch:e=>o("search",e),style:{width:250}}),s.a.createElement(Za.a,{type:"primary",icon:s.a.createElement(Go.a,null),style:{backgroundColor:"#09509d",borderColor:"#09509d"},onClick:()=>{l((e=>{const t=[],a=Object.keys(e[0]);return t.push(a.join(",")),e.map(e=>{t.push(Object.values(e).join(","))}),t.join("\n")})(a),"reports-all")}},"Download All"))),s.a.createElement(bo.a,{dataSource:a.filter(t=>{const a=""===e.status||t.status===e.status,n=""===e.search||(t._id+t.assignee).toLowerCase().includes(e.search.toLowerCase()),s=""===e.date||t.date===e.date;return a&&n&&s}),columns:n}))))}});var qo=Object(l.c)(e=>({reportPageProps:e.reportPageReducer}),e=>({getReports(){e(async e=>{e({type:He,payload:{loadingReports:!0}});const t={reports:[{_id:"001",assignee:"Jane Doe",date:"08-21-2022",status:"Resolved"},{_id:"002",assignee:"John Doe",date:"08-20-2022",status:"In Progress"},{_id:"003",assignee:"Astelle Von",date:"08-21-2022",status:"Not Started"},{_id:"004",assignee:"Michael Ross",date:"08-20-2022",status:"In Progress"}]},{reports:a}=t;e({type:ze,payload:{loadingReports:!1,reports:a}})})},resetPage(){e(async e=>e({type:$e}))},resetMeta(){e(async e=>e({type:Fe}))}}))($o);const{Search:Vo}=Qn.a,{Option:Ko}=Aa.a;const Yo={searchBox:{width:"12em"}};var Qo=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={pages:[],filters:{channel:"",search:""}}}componentDidMount(){this.props.getPages()}componentWillUnmount(){this.props.resetPage()}render(){const{filters:e}=this.state,{messengerIntegrationPage:t}=this.props,{pages:a}=t,n=[{title:"Page ID",dataIndex:"_id",key:"key"},{title:"Page Name",dataIndex:"pageName",key:"key"},{title:"Channel",dataIndex:"channel",key:"key"},{title:"Action",dataIndex:"action",key:"key",render:e=>"Disconnect"===e?s.a.createElement("span",{style:{color:"#e33434"}},e):s.a.createElement("span",{style:{color:"#26d367"}},e)}],o=(t,a)=>{const n=a||"",s=e;switch(t){case"channel":s.channel=n;break;case"search":s.search=n}this.setState({filters:s})};return s.a.createElement("div",{style:{width:"95%",margin:"auto"}},s.a.createElement(Zn.a,{title:"Messenger Integration"},s.a.createElement(Oa.b,{direction:"vertical",size:"middle",style:{display:"flex"}},s.a.createElement(Fa.a,{justify:"end"},s.a.createElement(Oa.b,null,s.a.createElement(Aa.a,{style:Yo.searchBox,allowClear:!0,placeholder:"Search by Channel",onChange:e=>o("channel",e)},s.a.createElement(Ko,{value:"Messenger"},"Messenger"),s.a.createElement(Ko,{value:"Instagram"},"Instagram"),s.a.createElement(Ko,{value:"Email"},"Email"),s.a.createElement(Ko,{value:"WhatsApp"},"WhatsApp")),s.a.createElement(Vo,{placeholder:"Search by Page ID, Page Name",allowClear:!0,onSearch:e=>o("search",e),style:{width:200}}),s.a.createElement(Za.a,{type:"primary",icon:s.a.createElement(Eo.a,null),style:{backgroundColor:"#09509d",borderColor:"#09509d"},onClick:()=>this.props.navigateToAddPage()},"New Page"))),s.a.createElement(bo.a,{dataSource:a.filter(t=>{const a=""===e.channel||t.channel===e.channel,n=""===e.search||(t._id+t.pageName+t.channel).toLowerCase().includes(e.search.toLowerCase());return a&&n}),columns:n}))))}});var Jo=Object(l.c)(e=>({messengerIntegrationPage:e.messengerIntegrationPageReducer}),e=>({getPages(){e(async e=>{e({type:je,payload:{loadingPages:!0}});const t={pages:[{_id:"001",pageName:"Page A",channel:"Instagram",action:"Connect"},{_id:"002",pageName:"Page B",channel:"Messenger",action:"Connect"},{_id:"003",pageName:"Page C",channel:"WhatsApp",action:"Connect"},{_id:"004",pageName:"Page D",channel:"Email",action:"Disconnect"}]},{pages:a}=t;e({type:Be,payload:{loadingPages:!1,pages:a}})})},resetPage(){e(async e=>e({type:Le}))},resetMeta(){e(async e=>e({type:Ge}))}}))(Qo);var Zo=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={value:"Hello world"}}render(){return s.a.createElement("div",{style:{display:"flex",textAlign:"center",justifyContent:"center",alignItems:"center",height:"100%"}},s.a.createElement(Zn.a,{title:"Messenger Settings Page",style:{width:"36em"}},s.a.createElement("h2",null,"Work in Progress")))}});var Xo=Object(l.c)(e=>({}),e=>({}))(Zo);var ei=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={value:"Hello world"}}render(){return s.a.createElement("div",{style:{display:"flex",textAlign:"center",justifyContent:"center",alignItems:"center",height:"100%"}},s.a.createElement(Zn.a,{title:"Subscription Page",style:{width:"36em"}},s.a.createElement("h2",null,"Work in Progress")))}});var ti=Object(l.c)(e=>({}),e=>({}))(ei),ai=a(1009);function ni({tabs:e,history:t}){const[a,o]=Object(n.useState)(""),{location:i}=t;Object(n.useEffect)(()=>{o(l)},[]);const l=(({pathname:t})=>{let a;return e.map(e=>(t.split("?")[0].includes(e.path.split("?")[0])&&(a=e.path),e)),a?a.split("?")[0]:null})({pathname:i.pathname.split("?")[0]})||e[0].path.split("?")[0];return s.a.createElement("div",{style:{overflow:"auto"}},s.a.createElement(ya.a,{onClick:e=>{o(e.key)},selectedKeys:[a],mode:"horizontal"},e&&e.map((e,a)=>s.a.createElement(ya.a.Item,{key:e.path.split("?")[0],style:{marginLeft:25},onClick:()=>l===e.path?void 0:t.push(e.path)}," ",e.title))))}var si=a(1025),oi=a(1026),ii=a(600),li=a.n(ii);const{Option:ri}=Aa.a,ci=[{name:"Permission A",value:"permission_a"},{name:"Permission B",value:"permission_b"}];var di=class extends n.Component{constructor(...e){super(...e),this.formRef=s.a.createRef(),this.state={disabled:!0},this.checkFormValues=(()=>{this.formRef.current.getFieldValue("name")&&this.formRef.current.getFieldValue("email")&&this.formRef.current.getFieldValue("status")&&this.setState({disabled:!1})})}async submitFormData(e){const{onSubmit:t}=this.props,{staff_id:a,name:n,email:s,status:o}=e,i={staff_id:a,name:n,email:s,status:o};await t(i)}renderForm(){const{staff:e,loadingSubmit:t}=this.props,{_id:a,name:n,email:o,enabled:i}=e||{};return s.a.createElement(s.a.Fragment,null,s.a.createElement(ls.a,{layout:"vertical",ref:this.formRef,initialValues:{staff_id:a,name:n,email:o,status:i?"active":"inactive"},style:{width:400,marginTop:"2rem"},onFinish:async e=>{await this.submitFormData(e)}},s.a.createElement(ls.a.Item,{name:"staff_id",label:"Staff ID"},s.a.createElement(Qn.a,{disabled:!0,onChange:this.checkFormValues})),s.a.createElement(ls.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Name is invalid"}]},s.a.createElement(Qn.a,null)),s.a.createElement(ls.a.Item,{name:"email",label:"Email Address",onChange:this.checkFormValues,rules:[{required:!0,type:"email",message:"Please enter a valid email"}]},s.a.createElement(Qn.a,null)),s.a.createElement(ls.a.Item,{name:"status",label:"Status"},s.a.createElement(Aa.a,{onChange:this.checkFormValues},li.a.status.map(e=>s.a.createElement(ri,{value:e},Qs.staffStatus(e))))),s.a.createElement(ls.a.List,{name:"selected_locations"},(e,{add:t,remove:a})=>s.a.createElement(s.a.Fragment,null,e.map(({key:e,name:t,fieldKey:a,...n},o)=>s.a.createElement("div",{key:e,style:{display:"flex",marginBottom:-20}},s.a.createElement(ls.a.Item,Object.assign({},n,{name:[t,"permission"],fieldKey:[a,"key"],label:0===o?"Permission:":"",style:{width:"100%",paddingRight:10},rules:[{required:!0,message:"Missing value"}]}),s.a.createElement(Aa.a,{key:e,onChange:e=>{const a=[...this.state.current_selected_locations.filter(e=>e!==this.state.current_selected_locations[t])];a.splice(t,0,e),this.setState({current_selected_locations:[...a]});const n=this.formRef.current.getFieldValue("selected_doors")&&this.formRef.current.getFieldValue("selected_doors").filter(t=>!!t&&t.location!==e);this.formRef.current.setFieldsValue({selected_doors:n})}},ci&&ci.length&&ci.map((e,t)=>s.a.createElement(Aa.a.Option,{key:t,value:e.value},e.name)))),s.a.createElement(si.a,{style:0===o?{marginTop:38}:{marginTop:8}}))),s.a.createElement(ls.a.Item,{style:{marginTop:10}},"Add Permission \xa0",s.a.createElement(oi.a,{onClick:()=>{t()},style:{fontSize:"110%",backgroundColor:"#fff",color:"#0B3266",cursor:"pointer"}})))),s.a.createElement(ls.a.Item,{style:{float:"right"}},s.a.createElement(Za.a,{size:"middle",type:"primary",htmlType:"submit",style:{width:100,borderRadius:3},loading:t,disabled:this.state.disabled},"Save"))))}render(){return s.a.createElement(s.a.Fragment,null,this.renderForm())}};const{Header:mi,Content:pi}=ha.a,{Title:ui}=Ea.a;var gi=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.state={disabled:!0}}componentDidUpdate(e,t){const{meta:a}=e.pageProps,{meta:n}=this.props.pageProps;if(n&&n!==a){const e={type:200===n.code?"success":"error",...40399===n.code&&{timeout:0}};this.props.alert.show(n.message,e),this.props.resetMeta()}}showForm(e){const{onSubmit:t}=this.props,{loadingSubmit:a}=this.props.pageProps;return s.a.createElement("div",{className:"main-content"},s.a.createElement(Fa.a,{justify:"space-around"},s.a.createElement(di,{staff:e,onSubmit:t,loadingSubmit:a})))}renderCreateForm(e){const{sections:t}=e;return s.a.createElement(s.a.Fragment,null,s.a.createElement(mi,{className:"breadcrumb-header",style:{backgroundColor:"white"}},s.a.createElement(Fa.a,null,s.a.createElement(ai.a,{span:21},s.a.createElement(fa.a,{style:{marginTop:"0.5rem"}},t&&t.map(e=>s.a.createElement(fa.a.Item,{key:e.key},e.link?s.a.createElement("a",{href:"#",onClick:e.onClick},e.content):e.content))),s.a.createElement(ui,{level:5,style:{paddingTop:10}},"Create Staff")))),s.a.createElement(pi,{style:{margin:"24px 16px 0",backgroundColor:"white"}},this.showForm()))}renderUpdateForm(){const{staff:e}=this.props.pageProps;return this.showForm(e)}render(){const{location:e,history:t}=this.props,{loading:a}=this.props.pageProps;if(a)return s.a.createElement(Sn,null);const{query:n}=ka()(e.search,!0),o={sections:[{key:"/staff",content:"Staff",link:!0,onClick:()=>t.push("/staffs")},{key:"Create",content:"Create",active:!0}],location:e,query:n};return s.a.createElement(s.a.Fragment,null,n&&n.id&&this.renderUpdateForm(),!n.id&&this.renderCreateForm(o))}});function hi(e){return async(t,a)=>{const{staff:n}=a().staffDetailsPageReducer;t({type:ot,payload:{loadingSubmit:!0}});const s={staff:{password:123456,...e}};let o;if(n._id?(s.staff.updated_at=n.updated_at,o=await fn.admin.users.updateStaffById(n._id,s)):o=await fn.admin.users.createStaff(s),200!==o.meta.code)return t({type:lt,payload:{loadingSubmit:!1,meta:o.meta}});const{staff:i}=o.data;t({type:it,payload:{loadingSubmit:!1,meta:o.meta,staff:i}}),t(Object(dn.d)(`/staffs/id/basic?id=${i._id}`))}}function Ei(){return async e=>e({type:dt})}var fi=Object(l.c)(e=>({pageProps:e.staffDetailsPageReducer}),e=>({onSubmit(t){e(hi(t))},resetMeta(){e(Ei())}}))(gi);var yi=class extends n.Component{showForm(){return s.a.createElement("div",{className:"main-content"},s.a.createElement(Fa.a,{justify:"space-around"},s.a.createElement("div",null," Tickets Page")))}render(){const{location:e}=this.props;return s.a.createElement(s.a.Fragment,null,this.showForm())}};var bi=Object(l.c)(e=>({}),e=>({}))(yi);const{Header:_i,Content:ki}=ha.a,{Title:Si}=Ea.a;var wi=Object(h.d)(Object(c.b)())(class extends n.Component{constructor(e){super(e),this.getStaffDetailsPageComponent=(()=>{const e=this.props.location.pathname.split("/"),t=e[e.length-1];switch(!0){case"basic"===t:return s.a.createElement(fi,this.props);case"tickets"===t:return s.a.createElement(bi,this.props);default:return this.props.history.push("/staffs")}}),this.state={staff:{}}}componentDidMount(){const{location:e}=this.props,{query:t}=ka()(e.search,!0);this.props.getStaffById(t.id)}componentWillUnmount(){this.props.resetPage()}render(){const{pageProps:e,location:t,history:a}=this.props,{query:n}=ka()(t.search,!0),o=[{key:"/staff",content:"Staff",link:!0},{key:"Details",content:"Details",active:!0}],i=[{title:"Basic",path:`/staffs/id/basic?id=${n.id}`},{title:"Tickets",path:`/staffs/id/tickets?id=${n.id}`}];return s.a.createElement(s.a.Fragment,null,s.a.createElement(_i,{className:"breadcrumb-header",style:{backgroundColor:"white"}},s.a.createElement(Fa.a,null,s.a.createElement(ai.a,{span:21},s.a.createElement(fa.a,{style:{marginTop:"0.5rem"}},o&&o.map(e=>s.a.createElement(fa.a.Item,{key:e.key},e.link?s.a.createElement("a",{href:"#",onClick:e.onClick},e.content):e.content))),s.a.createElement(Si,{level:5,style:{paddingTop:10}},"Staff Detail")))),s.a.createElement(ki,{style:{margin:"24px 16px 0",backgroundColor:"white"}},s.a.createElement(ni,{tabs:i,location:t,history:a}),this.getStaffDetailsPageComponent()))}});var Ti=Object(l.c)(e=>({pageProps:e.staffDetailsPageReducer}),e=>({getStaffById(t){e(function(e){return async t=>{t({type:Qe,payload:{loading:!0}});const a=await fn.admin.users.getStaffById(e);if(200!==a.meta.code)return t({type:Je,payload:{loading:!1}});const{staff:n}=a.data;t({type:Ze,payload:{loading:!1,staff:n}})}}(t))},navigateToListPage(){e(async e=>{e(Object(dn.d)("/staffs"))})},onSubmit(t){e(hi(t))},resetPage(){e(async e=>e({type:ct}))},resetMeta(){e(Ei())}}))(wi);const Ci=[{path:"/unauthorized",exact:!0,isPrivate:!1,Layout:ga,layoutClass:"narrow",Component:vn},{path:"/login",exact:!0,isPrivate:!1,Layout:ga,layoutClass:"narrow",Component:yn},{path:"/logout",exact:!0,isPrivate:!1,Layout:ga,layoutClass:"narrow",Component:Cn},{path:"/register",exact:!0,isPrivate:!1,Layout:ga,layoutClass:"narrow",Component:Pn},{path:"/forgot-password",exact:!0,isPrivate:!1,Layout:ga,layoutClass:"narrow",Component:Rn},{path:"/customer-form",exact:!0,isPrivate:!0,Layout:ga,layoutClass:"narrow",Component:xn,forStaff:!1},{path:"/tickets",exact:!0,isPrivate:!0,Layout:Ya,title:"Tickets",layoutClass:"narrow",Component:Hs,forStaff:!0},{path:"/settings",exact:!0,isPrivate:!0,Layout:Ya,title:"Settings",layoutClass:"narrow",Component:go,forStaff:!1},{path:"/staffs",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:So,forStaff:!1},{path:"/dashboard",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:Lo,forStaff:!1},{path:"/reports",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:qo,forStaff:!1},{path:"/messenger-integration",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:Jo,forStaff:!1},{path:"/messenger-settings",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:Xo,forStaff:!1},{path:"/subscription",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:ti,forStaff:!1},{path:"/staffs/create",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:fi,forStaff:!1},{path:"/staffs/id/basic",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:Ti,forStaff:!1},{path:"/staffs/id/tickets",exact:!0,isPrivate:!0,Layout:Ya,title:" ",layoutClass:"narrow",Component:Ti,forStaff:!1}];function vi(e){return"/login"===e.pathname.split("?")[0]&&e.pathname.split("?").length>1?e.pathname+e.search+e.hash:-1!==["/login","/logout"].indexOf(e.pathname.split("?")[0])?"/login":`/login?path=${e.pathname+e.search+e.hash}`}const Ii=({layout:e,layoutClass:t,component:a,title:n,forStaff:o,...i})=>s.a.createElement(la.b,Object.assign({},i,{render:i=>{if(pa.isAuthenticated()){const l=localStorage.getItem("app")?JSON.parse(localStorage.getItem("app")).type:"";return o||"staff"!==l?s.a.createElement(e,{containerClass:t,title:n},s.a.createElement(a,i)):s.a.createElement(la.a,{to:{pathname:"/tickets",state:{from:i.location}}})}return s.a.createElement(la.a,{to:{pathname:vi(i.location),state:{from:i.location}}})}}));var xi=Object(la.g)(class extends n.Component{render(){const{location:e}=this.props;return s.a.createElement(la.d,{location:e},Ci.map(({path:t,exact:a,isPrivate:n,Layout:o,layoutClass:i,Component:l,title:r,forStaff:c})=>n?s.a.createElement(Ii,{key:0,path:t,exact:a,layout:o,layoutClass:i,component:l,title:r,forStaff:c}):s.a.createElement(la.b,{key:0,path:t,exact:a,render:t=>s.a.createElement(o,{containerClass:i,location:e},s.a.createElement(l,t))})),s.a.createElement(la.b,{render:e=>pa.isAuthenticated()?s.a.createElement(la.a,{to:"/tickets"}):s.a.createElement(la.a,{to:vi(e.location)})}))}});g.a.load({google:{families:["Libre Franklin:300,400,500","Roboto","sans-serif"]}});i.a.render(s.a.createElement(l.a,{store:(()=>{if(ia)return ia;const e=[f.a,Object(E.a)(oa)],t=Object(h.d)(Object(h.a)(...e),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__():Object(h.d)());return ia=Object(h.e)((e=>Object(h.c)({form:b.a,router:Object(r.b)(e),loginPageReducer:Ht,registerPageReducer:zt,forgotPasswordReducer:qt,ticketPageReducer:Kt,staffListReducer:Qt,settingsPageReducer:Zt,staffDetailsPageReducer:ea,messengerIntegrationPageReducer:aa,reportPageReducer:sa}))(oa),{},t)})()},s.a.createElement(p.a,{i18n:m},s.a.createElement(c.a,Object.assign({template:d.a},{position:"bottom right",timeout:5e3,offset:"30px",transition:"scale",containerStyle:{zIndex:1001}}),s.a.createElement(r.a,{history:oa},s.a.createElement(xi,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[618,1,2]]]);
//# sourceMappingURL=main.081431b3.chunk.js.map